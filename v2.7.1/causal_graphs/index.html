<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Causal graphs · CausalityTools.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="https://fonts.googleapis.com/css?family=Montserrat|Source+Code+Pro&amp;display=swap" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img class="docs-light-only" src="../assets/logo.png" alt="CausalityTools.jl logo"/><img class="docs-dark-only" src="../assets/logo-dark.png" alt="CausalityTools.jl logo"/></a><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Overview</a></li><li><a class="tocitem" href="../measures/">Association measures</a></li><li><a class="tocitem" href="../independence/">Independence testing</a></li><li class="is-active"><a class="tocitem" href>Causal graphs</a><ul class="internal"><li><a class="tocitem" href="#Causal-graph-API"><span>Causal graph API</span></a></li><li><a class="tocitem" href="#[Optimal-causation-entropy](@ref)"><span>Optimal causation entropy</span></a></li><li><a class="tocitem" href="#[PC](@ref)"><span>PC</span></a></li></ul></li><li><a class="tocitem" href="../api/">APIs and estimators</a></li><li><a class="tocitem" href="../examples/">Examples</a></li><li><a class="tocitem" href="../coupled_systems/">Predefined systems</a></li><li><a class="tocitem" href="../experimental/">Experimental</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Causal graphs</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Causal graphs</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaDynamics/CausalityTools.jl/blob/master/docs/src/causal_graphs.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="causal_graphs"><a class="docs-heading-anchor" href="#causal_graphs">Inferring causal graphs</a><a id="causal_graphs-1"></a><a class="docs-heading-anchor-permalink" href="#causal_graphs" title="Permalink"></a></h1><p>Directed causal graphical models, estimated on observed data, is an incredibly useful framework for causal inference. There exists a plethora of methods for estimating such models.</p><p>Useful reading:</p><ul><li><strong>Pearl, J. Glymour, M., &amp; Jewell, N. P. (2016). Causal inference in statistics:   A primer. John Wiley &amp; Sons</strong>. An excellent introductory book, suitable for anyone   interested, from a beginners to experts.</li><li><strong>Glymour, C., Zhang, K., &amp; Spirtes, P. (2019). Review of causal discovery methods   based on graphical models. Frontiers in genetics, 10, 524</strong>. The authoritative   overview of causal discovery from graphical models. Many more methods have also emerged   since this paper.</li></ul><h2 id="Causal-graph-API"><a class="docs-heading-anchor" href="#Causal-graph-API">Causal graph API</a><a id="Causal-graph-API-1"></a><a class="docs-heading-anchor-permalink" href="#Causal-graph-API" title="Permalink"></a></h2><p>The API for inferring causal graphs is defined by:</p><ul><li><a href="#CausalityTools.infer_graph"><code>infer_graph</code></a></li><li><a href="#CausalityTools.GraphAlgorithm"><code>GraphAlgorithm</code></a>, and its subtypes</li></ul><article class="docstring"><header><a class="docstring-binding" id="CausalityTools.infer_graph" href="#CausalityTools.infer_graph"><code>CausalityTools.infer_graph</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">infer_graph(algorithm::GraphAlgorithm, x) → g</code></pre><p>Infer graph from input data <code>x</code> using the given <code>algorithm</code>.</p><p>Returns <code>g</code>, whose type depends on <code>algorithm</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/CausalityTools.jl/blob/f1bc2b768778f2670587c87022f5e314e85eab0c/src/causal_graphs/api.jl#L15-L21">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CausalityTools.GraphAlgorithm" href="#CausalityTools.GraphAlgorithm"><code>CausalityTools.GraphAlgorithm</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">GraphAlgorithm</code></pre><p>The supertype of all causal graph inference algorithms.</p><p><strong>Concrete implementations</strong></p><ul><li><a href="#CausalityTools.OCE"><code>OCE</code></a>. The optimal causation entropy algorithm for time series graphs.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/CausalityTools.jl/blob/f1bc2b768778f2670587c87022f5e314e85eab0c/src/causal_graphs/api.jl#L4-L12">source</a></section></article><h2 id="[Optimal-causation-entropy](@ref)"><a class="docs-heading-anchor" href="#[Optimal-causation-entropy](@ref)"><a href="@ref">Optimal causation entropy</a></a><a id="[Optimal-causation-entropy](@ref)-1"></a><a class="docs-heading-anchor-permalink" href="#[Optimal-causation-entropy](@ref)" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="CausalityTools.OCE" href="#CausalityTools.OCE"><code>CausalityTools.OCE</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">OCE &lt;: GraphAlgorithm
OCE(; utest::IndependenceTest = SurrogateTest(MIShannon(), KSG2(k = 3, w = 3)),
      ctest::C = LocalPermutationTest(CMIShannon(), MesnerShalizi(k = 3, w = 3)),
      τmax::T = 1, α = 0.05)</code></pre><p>The optimal causation entropy (OCE) algorithm for causal discovery (Sun et al., 2015)<sup class="footnote-reference"><a id="citeref-Sun2015" href="#footnote-Sun2015">[Sun2015]</a></sup>.</p><p><strong>Description</strong></p><p>The OCE algorithm has three steps to determine the parents of a variable <code>xᵢ</code>.</p><ol><li>Perform pairwise independence tests using <code>utest</code> and select the variable <code>xⱼ(-τ)</code>  that has the highest significant (i.e. with associated p-value below <code>α</code>)  association with <code>xᵢ(0)</code>. Assign it to the set of selected parents <code>P</code>.</li><li>Perform conditional independence tests using <code>ctest</code>, finding the parent  <code>Pₖ</code> that has the highest association with <code>xᵢ</code> given the already selected parents,  and add it to <code>P</code>.  Repeat until no more variables with significant association are found.</li><li>Backwards elimination of parents <code>Pₖ</code> of <code>xᵢ(0)</code> for which <code>xᵢ(0) ⫫ Pₖ | P - {Pₖ}</code>,  where <code>P</code> is the set of parent nodes found in the previous steps.</li></ol><p><code>τmax</code> indicates the maximum lag <code>τ</code> between the target variable <code>xᵢ(0)</code> and its potential parents <code>xⱼ(-τ)</code>. Sun et al. 2015&#39;s method is based on <code>τmax = 1</code>.</p><p><strong>Returns</strong></p><p>When used with <a href="#CausalityTools.infer_graph"><code>infer_graph</code></a>, it returns a vector <code>p</code>, where <code>p[i]</code> are the parents for each input variable. This result can be converted to a <code>SimpleDiGraph</code> from Graphs.jl (see <a href="../examples/examples_graphs/#oce_example">example</a>).</p><p><strong>Examples</strong></p><ul><li><a href="../examples/examples_graphs/#oce_example">Inferring time series graph from a chain of logistic maps</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/CausalityTools.jl/blob/f1bc2b768778f2670587c87022f5e314e85eab0c/src/causal_graphs/oce/OCE.jl#L6-L44">source</a></section></article><h2 id="[PC](@ref)"><a class="docs-heading-anchor" href="#[PC](@ref)"><a href="@ref">PC</a></a><a id="[PC](@ref)-1"></a><a class="docs-heading-anchor-permalink" href="#[PC](@ref)" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="CausalityTools.PC" href="#CausalityTools.PC"><code>CausalityTools.PC</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">PC &lt;: GraphAlgorithm
PC(pairwise_test, conditional_test;
    α = 0.05, max_depth = Inf, maxiters_orient = Inf)</code></pre><p>The PC algorithm (Spirtes et al., 2000)<sup class="footnote-reference"><a id="citeref-Spirtes2000" href="#footnote-Spirtes2000">[Spirtes2000]</a></sup>, which is named named after the <em>first names</em> of the authors, <strong>P</strong>eter Spirtes and <strong>C</strong>lark Glymour, which is implemented as described in Kalisch &amp; Bühlmann (2008)<sup class="footnote-reference"><a id="citeref-Kalisch2008" href="#footnote-Kalisch2008">[Kalisch2008]</a></sup>.</p><p><strong>Arguments</strong></p><ul><li><strong><code>pairwise_test</code></strong>: An <a href="../independence/#CausalityTools.IndependenceTest"><code>IndependenceTest</code></a> that uses a pairwise,   nondirectional <a href="../measures/#CausalityTools.AssociationMeasure"><code>AssociationMeasure</code></a> measure (e.g. a parametric   <a href="../independence/#CausalityTools.CorrTest"><code>CorrTest</code></a>, or <a href="../independence/#CausalityTools.SurrogateTest"><code>SurrogateTest</code></a> with the <a href="../measures/#CausalityTools.MIShannon"><code>MIShannon</code></a> measure).</li><li><strong><code>conditional_test</code></strong>: An <a href="../independence/#CausalityTools.IndependenceTest"><code>IndependenceTest</code></a> that uses a conditional,   nondirectional <a href="../measures/#CausalityTools.AssociationMeasure"><code>AssociationMeasure</code></a> (e.g. <a href="../independence/#CausalityTools.CorrTest"><code>CorrTest</code></a>,   or <a href="../independence/#CausalityTools.SurrogateTest"><code>SurrogateTest</code></a> with the <a href="../measures/#CausalityTools.CMIShannon"><code>CMIShannon</code></a> measure).</li></ul><p><strong>Keyword arguments</strong></p><ul><li><strong><code>α::Real</code></strong>. The significance level of the test.</li><li><strong><code>max_depth</code></strong>. The maximum level of conditional indendence tests to be   performed. By default, there is no limit (i.e. <code>max_depth = Inf</code>), meaning that   maximum depth is <code>N - 2</code>, where <code>N</code> is the number of input variables.</li><li><strong><code>maxiters_orient::Real</code></strong>. The maximum number of times to apply the orientation   rules. By default, there is not limit (i.e. <code>maxiters_orient = Inf</code>).</li></ul><div class="admonition is-info"><header class="admonition-header">Directional measures will not give meaningful answers</header><div class="admonition-body"><p>During the skeleton search phase, if a significance association between two nodes are is found, then a bidirectional edge is drawn between them. The generic implementation of <code>PC</code> therefore doesn&#39;t currently handle directional measures such as <a href="../measures/#CausalityTools.TEShannon"><code>TEShannon</code></a>. The reason is that if a  directional relationship <code>X → Y</code> exists between two nodes <code>X</code> and <code>Y</code>, then the algorithm would first draw a bidirectional arrow between <code>X</code> and <code>Y</code> when analysing the direction <code>X → Y</code>, and then removing it again when analysing in the direction <code>Y → X</code> (a similar situation would also occur for the conditional stage). This will be fixed in a future release. For now, use nondirectional measures, e.g. <a href="../measures/#CausalityTools.MIShannon"><code>MIShannon</code></a> and <a href="../measures/#CausalityTools.CMIShannon"><code>CMIShannon</code></a>!</p></div></div><p><strong>Description</strong></p><p>When used with <a href="#CausalityTools.infer_graph"><code>infer_graph</code></a> on some input data <code>x</code>, the <code>PC</code> algorithm performs the following steps:</p><ol><li>Initialize an empty fully connected graph <code>g</code> with <code>N</code> nodes, where <code>N</code> is the number  of variables and <code>x[i]</code> is the data for the <code>i</code>-th node.</li><li>Reduce the fully connected <code>g</code> to a skeleton graph by performing pairwise  <a href="../independence/#CausalityTools.independence"><code>independence</code></a> tests between all vertices using <code>pairwise_test</code>. Remove  any edges where adjacent vertices are found to be independent according to the test  (i.e. the null hypothesis of independence cannot be rejected at significance level  <code>1 - α</code>).</li><li>Thin the skeleton <code>g</code> by conditional <a href="../independence/#CausalityTools.independence"><code>independence</code></a> testing. If  <code>x[i] ⫫ x[j] | x[Z]</code> for some set of variables <code>Z</code> (not including <code>i</code> and <code>j</code>)  according to <code>conditional_test</code> (i.e. the null hypothesis of conditional independence  cannot be rejected at significance level <code>1 - α</code>), then the edge between <code>i</code> and <code>j</code> is  removed, and we record the separating set S(i, j) = Z. Independence tests are first  performed for conditioning sets of size 1, and repeated for conditioning sets of  increasing size, which in most cases limits the number of tests needed.  The separating  sets <code>S(i, j)</code>, which records which variables were in the conditioning set that  rendered variables <code>i</code> and <code>j</code> independent, are recorded.  If <code>max_depth</code> is an integer, then this procedure is performed on conditioning  sets of sizes <code>1:max_depth</code>, and if <code>max_depth == nothing</code>, then all possible  conditioning set sizes are potentially used.</li><li>Create a directed graph <code>dg</code> from <code>g</code> by replacing every  undirected edge <code>X - Y</code> in <code>g</code> by the bidirectional edge <code>X ↔ Y</code> (i.e.  construct two directional edges <code>X → Y</code> and <code>Y → X</code>). Orientiation rules 0-3  are then repeatedly applied to <code>dg</code> until no more edges can be oriented:<ul><li>Rule 0 (orients v-structures): <code>X ↔ Y ↔ Z</code> becomes <code>X → Y ← Z</code> if <code>Y</code> is not in the   separating set <code>S(X, Z)</code>.</li><li>Rule 1 (prevents new v-structures): <code>X → Y ↔ Z</code> becomes <code>X → Y → Z</code> if <code>X</code> and <code>Z</code>   are not adjacent.</li><li>Rule 2 (avoids cycles): <code>X → Y → Z ↔ X</code> becomes <code>X → Y → Z ← X</code>.</li><li>Rule 3: To avoid creating cycles or new v-structures, whenever <code>X - Y → Z</code>,   <code>X - W → Z</code>, and <code>X - Z</code> but there is no edge between <code>Y</code> and <code>W</code>, turn the   undirected <code>X - Z</code> edge into the directed edge <code>X → Z</code>.</li></ul></li></ol><p>The resulting directed graph (a <code>SimpleDiGraph</code> from <a href="https://github.com/JuliaGraphs/Graphs.jl">Graphs.jl</a>) is then returned.</p><p><strong>Examples</strong></p><ul><li><a href="../examples/examples_graphs/#pc_examples_corr">PC algorithm with parametric independence tests</a></li><li><a href="../examples/examples_graphs/#pc_examples_nonparametric">PC algorithm with nonparametric independence tests</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/CausalityTools.jl/blob/f1bc2b768778f2670587c87022f5e314e85eab0c/src/causal_graphs/pc/PC.jl#L5-L95">source</a></section></article><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-Sun2015"><a class="tag is-link" href="#citeref-Sun2015">Sun2015</a>Sun, J., Taylor, D., &amp; Bollt, E. M. (2015). Causal network inference by optimal causation entropy. SIAM Journal on Applied Dynamical Systems, 14(1), 73-106.</li><li class="footnote" id="footnote-Kalisch2008"><a class="tag is-link" href="#citeref-Kalisch2008">Kalisch2008</a>Kalisch, M., &amp; Bühlmann, P. (2008). Robustification of the PC-algorithm for directed acyclic graphs. Journal of Computational and Graphical Statistics, 17(4), 773-789.</li><li class="footnote" id="footnote-Spirtes2000"><a class="tag is-link" href="#citeref-Spirtes2000">Spirtes2000</a>Spirtes, P., Glymour, C. N., Scheines, R., &amp; Heckerman, D. (2000). Causation, prediction, and search. MIT press.</li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../independence/">« Independence testing</a><a class="docs-footer-nextpage" href="../api/">APIs and estimators »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Sunday 9 April 2023 13:13">Sunday 9 April 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
