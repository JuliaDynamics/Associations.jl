<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Predictive asymmetry · CausalityTools.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="https://fonts.googleapis.com/css?family=Montserrat|Source+Code+Pro&amp;display=swap" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img class="docs-light-only" src="../../assets/logo.png" alt="CausalityTools.jl logo"/><img class="docs-dark-only" src="../../assets/logo-dark.png" alt="CausalityTools.jl logo"/></a><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Overview</a></li><li><a class="tocitem" href="../../measures/">Association measures</a></li><li><a class="tocitem" href="../../independence/">Independence testing</a></li><li><a class="tocitem" href="../../causal_graphs/">Causal graphs</a></li><li><a class="tocitem" href="../../api/">APIs and estimators</a></li><li><a class="tocitem" href="../">Examples</a></li><li><a class="tocitem" href="../../coupled_systems/">Predefined systems</a></li><li><a class="tocitem" href="../../experimental/">Experimental</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Predictive asymmetry</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Predictive asymmetry</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaDynamics/CausalityTools.jl/blob/master/docs/src/examples/examples_predictive_asymmetry.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="examples_predictive_asymmetry"><a class="docs-heading-anchor" href="#examples_predictive_asymmetry">Predictive asymmetry</a><a id="examples_predictive_asymmetry-1"></a><a class="docs-heading-anchor-permalink" href="#examples_predictive_asymmetry" title="Permalink"></a></h1><h2 id="examples_pa_asymmetry_dist"><a class="docs-heading-anchor" href="#examples_pa_asymmetry_dist">Computing the asymmetry distribution</a><a id="examples_pa_asymmetry_dist-1"></a><a class="docs-heading-anchor-permalink" href="#examples_pa_asymmetry_dist" title="Permalink"></a></h2><p>The following example demonstrates how to compute the <a href="../../api/api_predictive_asymmetry/#CausalityTools.asymmetry"><code>asymmetry</code></a> distribution from time series input. We&#39;ll use timeseries from a chain of unidirectionally coupled logistic maps that are coupled <span>$X \to Y \to Z \to W$</span>.</p><p>These examples compute the asymmetry distribution directly. Use the <a href="../../measures/#CausalityTools.PA"><code>PA</code></a> measure with <a href="../../experimental/#CausalityTools.PATest"><code>PATest</code></a> for formal independence testing.</p><h3 id="Pairwise-analysis"><a class="docs-heading-anchor" href="#Pairwise-analysis">Pairwise analysis</a><a id="Pairwise-analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Pairwise-analysis" title="Permalink"></a></h3><p>When considering only two variables <span>$V_1$</span> and <span>$V_2$</span>, we expect the distribution <span>$\DeltaA_{X \to Y}$</span> to be skewed towards positive values if <span>$V_1 \to V2$</span>.</p><p>Parameters are tuned by providing an instance of the <a href="../../measures/#CausalityTools.PA"><code>PA</code></a> measure, which quantifies directional influence. We&#39;ll use the <a href="../../api/api_condmutualinfo/#CausalityTools.FPVP"><code>FPVP</code></a> estimator, and compute the asymmetry distribution over prediction lags <code>ηT = 1:10</code>. In real applications, it is important to ensure proper embeddings for the source (and conditional, if relevant) variables. We will optimize embedding parameters using the &quot;traditional&quot; approach from <a href="https://juliadynamics.github.io/DynamicalSystems.jl/dev/embedding/traditional/">DelayEmbeddings.jl</a>.</p><pre><code class="language-julia hljs">using CausalityTools
using DelayEmbeddings
using Random
rng = MersenneTwister(1234)

sys = system(Logistic4Chain(xi = [0.1, 0.2, 0.3, 0.4]; rng))
x, y, z, w = columns(trajectory(sys, 1000))
τx = estimate_delay(x, &quot;mi_min&quot;)
τy = estimate_delay(y, &quot;mi_min&quot;)
est = FPVP(; k = 3, w = 5)
ΔA_xy = asymmetry(PA(ηT = 1:10, τS = τx), est, x, y)
ΔA_yx = asymmetry(PA(ηT = 1:10, τS = τy), est, y, x)
ΔA_xy, ΔA_yx</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([0.3930530243654161, 0.5662202583131076, 0.4179975027058953, 0.3798815285596351, 0.27088523257836056, 0.13432418156168116, 0.05013821965994558, 0.06686323518457332, 0.05760224921743923, 0.017858733255036424], [-0.23381697381437622, -0.3949609955348535, -0.5361070481428912, -0.6203451337229594, -0.5261576343078946, -0.4094053773704249, -0.28726033746172963, -0.20569724668836825, -0.1317043485179289, -0.0329231925112789])</code></pre><p>As expected, since there is coupling <span>$X \to Y$</span>, <span>$\Delta A_{X \to Y}$</span> is skewed towards positive values, while <span>$\Delta A_{Y \to X}$</span> is skewed towards negative values because there is no coupling <span>$Y \to X$</span>.</p><h3 id="Conditional-analysis"><a class="docs-heading-anchor" href="#Conditional-analysis">Conditional analysis</a><a id="Conditional-analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Conditional-analysis" title="Permalink"></a></h3><p>What happens if we compute<span>$\Delta A_{X \to Z}$</span>? We&#39;d maybe expect there to be  some information transfer <span>$X \to Z$</span>, even though ther are not directly linked, because information is transferred through <span>$Y$</span>.</p><pre><code class="language-julia hljs">ΔA_xz = asymmetry(PA(ηT = 1:10, τS = estimate_delay(x, &quot;mi_min&quot;)), est, x, z)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">10-element Vector{Float64}:
 0.13893571225026374
 0.29102044341377764
 0.4455954575081342
 0.49036847279283086
 0.37260587196082123
 0.3571549676209272
 0.16646722405218622
 0.12392716511872809
 0.04015584392692911
 0.05813940322108041</code></pre><p>As expected, the distribution is still skewed towards positive values. To determine whether the information flow between <span>$x$</span> and <span>$z$</span> is mediated by <span>$y$</span>, we can compute the conditional distribution <span>$\Delta A_{X \to Z | Y}$</span>. If these values are still positively skewed, we conclude that <span>$Y$</span> is not a mediating variable. If conditioning on <span>$Y$</span> causes <span>$\Delta A_{X \to Z | Y}$</span> to not be skewed towards positive values any more, then we conclude that <span>$Y$</span> is a mediating variable and that <span>$X$</span> and <span>$Z$</span> are linked <span>$X \to Y \to Z$</span>.</p><p>In <a href="../examples_independence/#examples_patest">these examples</a>, the same time series are formally tested for independence using a <a href="../../experimental/#CausalityTools.PATest"><code>PATest</code></a>.</p></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Sunday 9 April 2023 13:13">Sunday 9 April 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
