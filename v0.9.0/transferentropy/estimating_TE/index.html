



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Causality detection from time series in Julia.">
      
      
      
        <meta name="author" content="Kristian Agasøster Haaga">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-0.17.5, mkdocs-material-2.9.4">
    
    
      
        <title>Methods - CausalityTools.jl</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.451f80e5.css">
      
      
    
    
      <script src="../../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
      <link rel="stylesheet" href="../../assets/Documenter.css">
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#transfer-entropy-estimation-procedure" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../.." title="CausalityTools.jl" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                CausalityTools.jl
              </span>
              <span class="md-header-nav__topic">
                Methods
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/kahaaga/CausalityTools.jl/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      GitHub
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../.." title="CausalityTools.jl" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    CausalityTools.jl
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/kahaaga/CausalityTools.jl/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      GitHub
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Causality estimation
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Causality estimation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../causalitytests/causality_from_time_series/" title="From time series" class="md-nav__link">
      From time series
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-2" type="checkbox" id="nav-2-2">
    
    <label class="md-nav__link" for="nav-2-2">
      From uncertain time series
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-2">
        From uncertain time series
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../causalitytests/causality_from_uncertain_data/" title="Methods" class="md-nav__link">
      Methods
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../causalitytests/causality_from_dynamical_systems/" title="From dynamical systems" class="md-nav__link">
      From dynamical systems
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Causality tests
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Causality tests
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../causalitytests/causality_tests/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2">
    
    <label class="md-nav__link" for="nav-3-2">
      Cross mappings
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-2">
        Cross mappings
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../causalitytests/CrossMappingTest/" title="CrossMappingTest" class="md-nav__link">
      CrossMappingTest
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../causalitytests/ConvergentCrossMappingTest/" title="ConvergentCrossMappingTest" class="md-nav__link">
      ConvergentCrossMappingTest
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-3" type="checkbox" id="nav-3-3">
    
    <label class="md-nav__link" for="nav-3-3">
      Distance based
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-3">
        Distance based
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../causalitytests/JointDistanceDistributionTest/" title="JointDistanceDistributionTest" class="md-nav__link">
      JointDistanceDistributionTest
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../causalitytests/SMeasureTest/" title="SMeasureTest" class="md-nav__link">
      SMeasureTest
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-4" type="checkbox" id="nav-3-4">
    
    <label class="md-nav__link" for="nav-3-4">
      Transfer entropy
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-4">
        Transfer entropy
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../causalitytests/TransferOperatorGridTest/" title="TransferOperatorGridTest" class="md-nav__link">
      TransferOperatorGridTest
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../causalitytests/VisitationFrequencyTest/" title="VisitationFrequencyTest" class="md-nav__link">
      VisitationFrequencyTest
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../causalitytests/NearestNeighbourMITest/" title="NearestNeighbourMITest" class="md-nav__link">
      NearestNeighbourMITest
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../causalitytests/ApproximateSimplexIntersectionTest/" title="ApproximateSimplexIntersectionTest" class="md-nav__link">
      ApproximateSimplexIntersectionTest
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../causalitytests/ExactSimplexIntersectionTest/" title="ExactSimplexIntersectionTest" class="md-nav__link">
      ExactSimplexIntersectionTest
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-5" type="checkbox" id="nav-3-5">
    
    <label class="md-nav__link" for="nav-3-5">
      Predictive asymmetry
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-5">
        Predictive asymmetry
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../causalitytests/PredictiveAsymmetryTest/" title="PredictiveAsymmetryTest" class="md-nav__link">
      PredictiveAsymmetryTest
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../causalitytests/NormalisedPredictiveAsymmetryTest/" title="NormalisedPredictiveAsymmetryTest" class="md-nav__link">
      NormalisedPredictiveAsymmetryTest
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Uncertainty handling and subsampling
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Uncertainty handling and subsampling
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../causalitytests/causality_from_uncertain_data_naive/" title="Naive resampling" class="md-nav__link">
      Naive resampling
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../causalitytests/causality_from_uncertain_data_naive_constrained/" title="ConstrainedTest" class="md-nav__link">
      ConstrainedTest
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../causalitytests/causality_from_uncertain_data_binneddatacausalitytest/" title="BinnedDataCausalityTest" class="md-nav__link">
      BinnedDataCausalityTest
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../causalitytests/causality_from_uncertain_data_InterpolateBinTest/" title="InterpolateBinTest" class="md-nav__link">
      InterpolateBinTest
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../causalitytests/causality_from_uncertain_data_RandomSequencesTest/" title="RandomSequencesTest" class="md-nav__link">
      RandomSequencesTest
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../causalitytests/causality_from_uncertain_data_strictlyincreasing_interpolated/" title="Strictly increasing and interpolated resampling" class="md-nav__link">
      Strictly increasing and interpolated resampling
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      CausalityToolsBase
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        CausalityToolsBase
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../causalitytoolsbase/discretization/" title="Discretization" class="md-nav__link">
      Discretization
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../causalitytoolsbase/delay_reconstructions/" title="Delay reconstruction" class="md-nav__link">
      Delay reconstruction
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      PerronFrobenius
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        PerronFrobenius
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../perronfrobenius/invariantmeasure/" title="Invariant measure" class="md-nav__link">
      Invariant measure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../perronfrobenius/transferoperator/" title="Transfer operator" class="md-nav__link">
      Transfer operator
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7" checked>
    
    <label class="md-nav__link" for="nav-7">
      Transfer entropy
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        Transfer entropy
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../TE_estimators/" title="Estimators" class="md-nav__link">
      Estimators
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Methods
      </label>
    
    <a href="./" title="Methods" class="md-nav__link md-nav__link--active">
      Methods
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#assigning-marginals" title="Assigning marginals" class="md-nav__link">
    Assigning marginals
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#computing-transfer-entropy-from-rectangular-partitions" title="Computing transfer entropy from rectangular partitions" class="md-nav__link">
    Computing transfer entropy from rectangular partitions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#computing-transfer-entropy-by-counting-nearest-neighbors" title="Computing transfer entropy by counting nearest neighbors" class="md-nav__link">
    Computing transfer entropy by counting nearest neighbors
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#computing-transfer-entropy-from-triangulated-partitions" title="Computing transfer entropy from triangulated partitions" class="md-nav__link">
    Computing transfer entropy from triangulated partitions
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../convenience_methods_te/" title="Convenience methods" class="md-nav__link">
      Convenience methods
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-4" type="checkbox" id="nav-7-4">
    
    <label class="md-nav__link" for="nav-7-4">
      Examples
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-7-4">
        Examples
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../examples_TE_different_partitionings/" title="Effect of discretization scheme" class="md-nav__link">
      Effect of discretization scheme
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      CrossMappings
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        CrossMappings
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../crossmappings/ccm/overview/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../crossmappings/ccm/crossmapping/" title="Cross mapping" class="md-nav__link">
      Cross mapping
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../crossmappings/ccm/convergentcrossmapping/" title="Converent cross mapping" class="md-nav__link">
      Converent cross mapping
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../algorithms/joint_distance_distribution/" title="Joint distance distribution" class="md-nav__link">
      Joint distance distribution
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../syntax_overview/" title="Syntax overview" class="md-nav__link">
      Syntax overview
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-11" type="checkbox" id="nav-11">
    
    <label class="md-nav__link" for="nav-11">
      Example systems
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-11">
        Example systems
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../example_systems/example_systems_overview/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../example_systems/example_systems_discrete/" title="Discrete systems" class="md-nav__link">
      Discrete systems
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../example_systems/example_systems_continuous/" title="Continuous systems" class="md-nav__link">
      Continuous systems
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../example_systems/noise/" title="Noise processes" class="md-nav__link">
      Noise processes
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-12" type="checkbox" id="nav-12">
    
    <label class="md-nav__link" for="nav-12">
      Surrogate data
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-12">
        Surrogate data
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../surrogates/surrogates_overview/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-12-2" type="checkbox" id="nav-12-2">
    
    <label class="md-nav__link" for="nav-12-2">
      Methods
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-12-2">
        Methods
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../surrogates/iaaft_docs/" title="IAAFT" class="md-nav__link">
      IAAFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../surrogates/aaft_docs/" title="AAFT" class="md-nav__link">
      AAFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../surrogates/randomphases_docs/" title="Fourier surrogates, random phases" class="md-nav__link">
      Fourier surrogates, random phases
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../surrogates/randomamplitudes_docs/" title="Fourier surrogates, random amplitudes" class="md-nav__link">
      Fourier surrogates, random amplitudes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../surrogates/randomshuffle_docs/" title="Random shuffle" class="md-nav__link">
      Random shuffle
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-13" type="checkbox" id="nav-13">
    
    <label class="md-nav__link" for="nav-13">
      Tutorials/examples
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-13">
        Tutorials/examples
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/list_of_tutorials/" title="List of tutorials" class="md-nav__link">
      List of tutorials
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-13-2" type="checkbox" id="nav-13-2">
    
    <label class="md-nav__link" for="nav-13-2">
      Causality from scalar data
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-13-2">
        Causality from scalar data
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/causality/tutorial_SMeasureTest/" title="SMeasureTest" class="md-nav__link">
      SMeasureTest
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-13-3" type="checkbox" id="nav-13-3">
    
    <label class="md-nav__link" for="nav-13-3">
      Causality from uncertain data
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-13-3">
        Causality from uncertain data
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/causality/Tutorial_BinnedResampling_RandomSequencesTest_PredictiveAsymmetryTest_ar1_unidir/" title="BinnedResampling + RandomSequencesTest" class="md-nav__link">
      BinnedResampling + RandomSequencesTest
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/causality/binned_uncertain_data/tutorial_BinnedDataCausalityTest_PredictiveAsymmetryTest_BinnedResampling/" title="BinnedResampling" class="md-nav__link">
      BinnedResampling
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/causality/binned_uncertain_data/tutorial_BinnedDataCausalityTest_PredictiveAsymmetryTest_BinnedMeanResampling/" title="BinnedMeanResampling" class="md-nav__link">
      BinnedMeanResampling
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-13-4" type="checkbox" id="nav-13-4">
    
    <label class="md-nav__link" for="nav-13-4">
      Worked examples
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-13-4">
        Worked examples
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../worked_examples/worked_example_transferentropy/" title="Transfer entropy" class="md-nav__link">
      Transfer entropy
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../CHANGELOG/" title="Changelog" class="md-nav__link">
      Changelog
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#assigning-marginals" title="Assigning marginals" class="md-nav__link">
    Assigning marginals
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#computing-transfer-entropy-from-rectangular-partitions" title="Computing transfer entropy from rectangular partitions" class="md-nav__link">
    Computing transfer entropy from rectangular partitions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#computing-transfer-entropy-by-counting-nearest-neighbors" title="Computing transfer entropy by counting nearest neighbors" class="md-nav__link">
    Computing transfer entropy by counting nearest neighbors
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#computing-transfer-entropy-from-triangulated-partitions" title="Computing transfer entropy from triangulated partitions" class="md-nav__link">
    Computing transfer entropy from triangulated partitions
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/kahaaga/CausalityTools.jl/edit/master/docs/transferentropy/estimating_TE.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <p><a id='te_estimators-1'></a></p>
<h1 id="transfer-entropy-estimation-procedure">Transfer entropy estimation procedure</h1>
<p><a id='te_assigning_marginals-1'></a></p>
<h2 id="assigning-marginals">Assigning marginals</h2>
<p>Assume we want to compute transfer entropy from a source variable <span><span class="MathJax_Preview">S</span><script type="math/tex">S</script></span>  to a target variable <span><span class="MathJax_Preview">T</span><script type="math/tex">T</script></span>, potentially conditioned on variable(s) <span><span class="MathJax_Preview">C</span><script type="math/tex">C</script></span>.   To control the transfer entropy, the analyst must </p>
<ol>
<li>Create a <a href="../../causalitytoolsbase/delay_reconstructions/#custom_delay_reconstruction-1">generalised delay reconstruction</a> from   the input data. In practice, this means that lagged instances of the time series   are organised in some data structure that can be sampled column-wise (e.g. a   <a href="../../causalitytoolsbase/delay_reconstructions/#custom_delay_reconstruction-1">custom delay reconstruction</a> or a <code>Dataset</code>).</li>
<li>Specify a <a href="../../causalitytoolsbase/discretization/#discretization-1">discretization scheme</a>, which can be either   <a href="../../causalitytoolsbase/discretization/#partition_rectangular-1">rectangular</a> or <a href="../../causalitytoolsbase/discretization/#partition_triangulated-1">triangulated</a>.</li>
<li>
<p>Map variables of the generalised delay reconstruction to the correct marginals. In   other words, which columns of the input data should be grouped in which marginals?   There are four marginals that must be assigned:</p>
<ul>
<li>The future of the target (<span><span class="MathJax_Preview">T_{f}</span><script type="math/tex">T_{f}</script></span>).</li>
<li>The present and past of the target variable (<span><span class="MathJax_Preview">T_{pp}</span><script type="math/tex">T_{pp}</script></span>).</li>
<li>The present and past of the source variable (<span><span class="MathJax_Preview">S_{pp}</span><script type="math/tex">S_{pp}</script></span>).</li>
<li>The present/past/future of any conditional variables (<span><span class="MathJax_Preview">C_{pp}</span><script type="math/tex">C_{pp}</script></span>). If <span><span class="MathJax_Preview">C_{pp}</span><script type="math/tex">C_{pp}</script></span> is non-empty,   then conditional transfer entropy will be computed. Otherwise, non-conditioned transfer    entropy is computed.</li>
</ul>
</li>
</ol>
<p>This is achieved by creating a <a href="./#TransferEntropy.TEVars-Tuple{}"><code>TEVars</code></a> instance, which refers to the columns of the  input data by their indices.</p>
<p><a id='TransferEntropy.TEVars-Tuple{}' href='#TransferEntropy.TEVars-Tuple{}'>#</a>
<strong><code>TransferEntropy.TEVars</code></strong> &mdash; <em>Method</em>.</p>
<div class="highlight"><pre><span></span><span class="n">TEVars</span><span class="p">(</span><span class="n">Tf</span><span class="o">::</span><span class="kt">Vector</span><span class="p">{</span><span class="kt">Int</span><span class="p">},</span> <span class="n">Tpp</span><span class="o">::</span><span class="kt">Vector</span><span class="p">{</span><span class="kt">Int</span><span class="p">},</span> <span class="n">Spp</span><span class="o">::</span><span class="kt">Vector</span><span class="p">{</span><span class="kt">Int</span><span class="p">})</span>
<span class="n">TEVars</span><span class="p">(</span><span class="n">Tf</span><span class="o">::</span><span class="kt">Vector</span><span class="p">{</span><span class="kt">Int</span><span class="p">},</span> <span class="n">Tpp</span><span class="o">::</span><span class="kt">Vector</span><span class="p">{</span><span class="kt">Int</span><span class="p">},</span> <span class="n">Spp</span><span class="o">::</span><span class="kt">Vector</span><span class="p">{</span><span class="kt">Int</span><span class="p">},</span> <span class="n">Cpp</span><span class="o">::</span><span class="kt">Vector</span><span class="p">{</span><span class="kt">Int</span><span class="p">})</span>

<span class="n">TEVars</span><span class="p">(;</span><span class="n">Tf</span> <span class="o">=</span> <span class="kt">Int</span><span class="p">[],</span> <span class="n">Tpp</span> <span class="o">=</span> <span class="kt">Int</span><span class="p">[],</span> <span class="n">Spp</span> <span class="o">=</span> <span class="kt">Int</span><span class="p">[],</span> <span class="n">Cpp</span> <span class="o">=</span> <span class="kt">Int</span><span class="p">[])</span> <span class="o">-&gt;</span> <span class="n">TEVars</span>
</pre></div>

<p>Which axes of the state space correspond to the future of the target (<code>Tf</code>), the present/past of the target (<code>Tpp</code>), the present/past of the source (<code>Spp</code>), and the present/past of any conditioned variables (<code>Cpp</code>)? Indices correspond to variables of the embedding or colums of a <code>Dataset</code>.</p>
<p>This information is used by the transfer entropy estimators to ensure the marginal distributions are computed correctly.</p>
<p><a id='te_estimation_rect-1'></a></p>
<h2 id="computing-transfer-entropy-from-rectangular-partitions">Computing transfer entropy from rectangular partitions</h2>
<p><a id='TransferEntropy.transferentropy-Tuple{Any,TEVars,RectangularBinning,BinningTransferEntropyEstimator}' href='#TransferEntropy.transferentropy-Tuple{Any,TEVars,RectangularBinning,BinningTransferEntropyEstimator}'>#</a>
<strong><code>TransferEntropy.transferentropy</code></strong> &mdash; <em>Method</em>.</p>
<div class="highlight"><pre><span></span><span class="n">transferentropy</span><span class="p">(</span><span class="n">pts</span><span class="p">,</span> <span class="n">vars</span><span class="o">::</span><span class="n">TEVars</span><span class="p">,</span> <span class="n">ϵ</span><span class="o">::</span><span class="n">RectangularBinning</span><span class="p">,</span> 
    <span class="n">estimator</span><span class="o">::</span><span class="n">BinningTransferEntropyEstimator</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Float64</span>
</pre></div>

<p>Compute the transfer entropy for a set of <code>pts</code> over the state space  partition specified by <code>ϵ</code> (a <a href="../../causalitytoolsbase/discretization/#CausalityToolsBase.RectangularBinning"><code>RectangularBinning</code></a> instance). </p>
<p><strong>Fields</strong></p>
<ul>
<li><strong><code>pts</code></strong>: An ordered set of <code>m</code>-dimensional points (<code>pts</code>) representing    an appropriate <a href="../(@ref custom_delay_reconstruction)">generalised embedding</a>    of some data series. Must be vector of states, not a vector of variables/time series.    Wrap your time series in a <code>DynamicalSystemsBase.Dataset</code> first if the latter is the case.</li>
<li><strong><code>vars::TEVars</code></strong>: A <a href="./#TransferEntropy.TEVars-Tuple{}"><code>TEVars</code></a> instance specifying how the <code>m</code> different    variables of <code>pts</code> are to be mapped into the marginals required for transfer    entropy computation.</li>
<li><strong><code>ϵ::RectangularBinning</code></strong>: A <a href="../../causalitytoolsbase/discretization/#CausalityToolsBase.RectangularBinning"><code>RectangularBinning</code></a> instance that    dictates how the point cloud (state space reconstruction) should be discretized.</li>
<li><strong><code>estimator::BinningTransferEntropyEstimator</code></strong>. There are different ways of    computing the transfer entropy over a discretization of a point cloud.   The <code>estimator</code> should be a valid <a href="../TE_estimators/#TransferEntropy.TransferEntropyEstimator"><code>TransferEntropyEstimator</code></a>   that works for rectangular partitions, for example <code>VisitationFrequency()</code>   or <code>TransferOperatorGrid()</code>. The field <code>estimator.b</code> sets the base of the    logarithm used for the computations (e.g <code>VisitationFrequency(b = 2)</code> computes    the transfer entropy in bits using the <a href="../@ref">VisitationFrequency</a> estimator).</li>
</ul>
<p><strong>Returns</strong></p>
<p>A single number that is the transfer entropy for the discretization of <code>pts</code> using the binning scheme <code>ϵ</code>, using the provided <code>estimator</code>. </p>
<p><strong>Long example</strong></p>
<div class="highlight"><pre><span></span>using TransferEntropy, DynamicalSystems
</pre></div>

<p><strong>1. Generate some example time series</strong></p>
<p>Let's generate some random noise series and use those as our time series.</p>
<div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">rand</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">rand</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
</pre></div>

<p>We need <code>pts</code> to be a vector of states. Therefore, collect the time series in a  <code>DynamicalSystems.Dataset</code> instance. This way, the states of the composite system will be represented as a <code>Vector{SVector}</code>.</p>
<div class="highlight"><pre><span></span><span class="n">raw_timeseries</span> <span class="o">=</span> <span class="n">Dataset</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>

<p><strong>2. Generalised embedding</strong></p>
<p><em>Note: If your data are already organised in a form of a  <a href="../../causalitytoolsbase/delay_reconstructions/#custom_delay_reconstruction-1">generalised embedding</a>,  where columns of the dataset correspond to lagged variables of the time series,  you can skip to step 3.</em></p>
<p>Say we want to compute transfer entropy from <span><span class="MathJax_Preview">x</span><script type="math/tex">x</script></span> to <span><span class="MathJax_Preview">y</span><script type="math/tex">y</script></span>, and that we  require a 4-dimensional embedding. For that, we need to decide on a  generalised state space reconstruction of the time series. One possible choice  is </p>
<div>
<div class="MathJax_Preview">
E = \{S_{pp}, T_{pp}, T_f \}= \{x_t, (y_t, y_{t-\tau}), y_{t+\eta} \}
</div>
<script type="math/tex; mode=display">
E = \{S_{pp}, T_{pp}, T_f \}= \{x_t, (y_t, y_{t-\tau}), y_{t+\eta} \}
</script>
</div>
<p>If so, we're computing the following TE</p>
<div>
<div class="MathJax_Preview">
TE_{x \to y} =  \int_E P(x_t, y_{t-\tau} y_t, y_{t + \eta}) \log{\left( \dfrac{P(y_{t + \eta} | (y_t, y_{t - \tau}, x_t)}{P(y_{t + \eta} | y_t, y_{t-\tau})} \right)}.
</div>
<script type="math/tex; mode=display">
TE_{x \to y} =  \int_E P(x_t, y_{t-\tau} y_t, y_{t + \eta}) \log{\left( \dfrac{P(y_{t + \eta} | (y_t, y_{t - \tau}, x_t)}{P(y_{t + \eta} | y_t, y_{t-\tau})} \right)}.
</script>
</div>
<p>To create the embedding, we'll use the <a href="../../causalitytoolsbase/delay_reconstructions/#CausalityToolsBase.customembed"><code>customembed</code></a> function (check its  documentation for a detailed explanation on how it works). This is basically just  making lagged copies of the time series, and stacking them next to each other  as column vectors. The order in which we arrange the lagged time series is not  important per se, but we need to keep track of the ordering, because that  information is crucial to the transfer entropy estimator.</p>
<p>According to the reconstruction we decided on above, we need to put the lagged  time series for <code>y</code> (the target variable) in the first three columns. The lags  for those columns are <code>η, 0, -τ</code>, in that order. Next, we need to put the  time series for <code>x</code> (the source variable) in the fourth column (which is not  lagged).</p>
<div class="highlight"><pre><span></span><span class="n">τ</span> <span class="o">=</span> <span class="n">optimal_delay</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="c"># find the optimal embedding lag</span>
<span class="n">η</span> <span class="o">=</span> <span class="mi">2</span> <span class="c"># prediction lag (your choice as an analyst)</span>
<span class="n">embedding_pts</span> <span class="o">=</span> <span class="n">customembed</span><span class="p">(</span><span class="n">raw_timeseries</span><span class="p">,</span> <span class="n">Positions</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">Lags</span><span class="p">(</span><span class="n">η</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">τ</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
</pre></div>

<p>The combination of the <code>Positions</code> instance and the <code>Lags</code> instance gives us  the necessary information about which time series in <code>raw_timeseries</code> that  corresponds to columns of the embedded dataset, and which lags each of the columns have.</p>
<p><strong>3. Instructions to the estimator</strong></p>
<p>The transfer entropy estimators needs the following about the columns of  the generalised reconstruction of your time series (<code>embedding_pts</code> in  our case):</p>
<ul>
<li>Which columns correspond to the future of the target variable (<span><span class="MathJax_Preview">T_f</span><script type="math/tex">T_f</script></span>`)?</li>
<li>Which columns correspond to the present and past of the target variable (<span><span class="MathJax_Preview">T_{pp}</span><script type="math/tex">T_{pp}</script></span>`)?</li>
<li>Which columns correspond to the present and past of the source variable (<span><span class="MathJax_Preview">S_{pp}</span><script type="math/tex">S_{pp}</script></span>`)?</li>
<li>Which columns correspond to the present/past/future of any variables    that we are to condition on (<span><span class="MathJax_Preview">C_{pp}</span><script type="math/tex">C_{pp}</script></span>)?</li>
</ul>
<p>This information is needed to ensure that marginals are properly assigned during transfer  entropy computation. The estimators accept this information in the form of a <code>TEVars</code>  instance, which can be constructed like so:</p>
<div class="highlight"><pre><span></span><span class="n">vars</span> <span class="o">=</span> <span class="n">TEVars</span><span class="p">(</span><span class="n">Tf</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">Tpp</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">Spp</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">])</span>
</pre></div>

<p><strong>4. Rectangular grid specification</strong></p>
<p>Entropy is essentially a property of a collection of states. To meaningfully talk about  states for our generalised state space reconstruction, we will divide the coordinate  axes of the reconstruction into a rectangular grid. Each box in the grid will  be considered a state, and the probability of visitation is equally distributed  within the box. </p>
<p>In this example, we'll use a rectangular partition where the box sizes are  determined by splitting each coordinate axis into 6 equally spaced  intervals, spanning the range of the data.</p>
<div class="highlight"><pre><span></span><span class="n">binning</span> <span class="o">=</span> <span class="n">RectangularBinning</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
</pre></div>

<p><strong>5. Compute transfer entropy</strong></p>
<p>Now we're ready to compute transfer entropy. First, let's use the  <a href="../TE_estimators/#TransferEntropy.VisitationFrequency"><code>VisitationFrequency</code></a> estimator with logarithm to the base 2. This  gives the transfer entropy in units of bits.</p>
<div class="highlight"><pre><span></span><span class="n">estimator</span> <span class="o">=</span> <span class="n">VisitationFrequency</span><span class="p">(</span><span class="n">b</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">te_vf</span> <span class="o">=</span> <span class="n">transferentropy</span><span class="p">(</span><span class="n">embedding_pts</span><span class="p">,</span> <span class="n">vars</span><span class="p">,</span> <span class="n">binning</span><span class="p">,</span> <span class="n">estimator</span><span class="p">)</span> <span class="c">#, or</span>
</pre></div>

<p>Okay, but what if we want to use another estimator and want the transfer  entropy in units of nats? Easy. </p>
<div class="highlight"><pre><span></span><span class="n">estimator</span> <span class="o">=</span> <span class="n">TransferOperatorGrid</span><span class="p">(</span><span class="n">b</span> <span class="o">=</span> <span class="n">Base</span><span class="o">.</span><span class="n">MathConstants</span><span class="o">.</span><span class="nb">e</span><span class="p">)</span>
<span class="n">transferentropy</span><span class="p">(</span><span class="n">embedding_pts</span><span class="p">,</span> <span class="n">vars</span><span class="p">,</span> <span class="n">binning</span><span class="p">,</span> <span class="n">estimator</span><span class="p">)</span>
</pre></div>

<p>Above, we computed transfer entropy for one particular choice of partition.  Transfer entropy is a function of the  partition, and care must be taken with  the choice of partition. Below is an example where we compute transfer entropy  over 15 different cubic grids spanning the range of the data, with differing box sizes  all having fixed edge lengths  (logarithmically spaced from 0.001 to 0.3).</p>
<div class="highlight"><pre><span></span><span class="c"># Define estimator</span>
<span class="n">est</span> <span class="o">=</span> <span class="n">VisitationFrequency</span><span class="p">(</span><span class="n">b</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>

<span class="c"># Define binning schemes based on different box sizes</span>
<span class="n">edgelengths</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">.^</span> <span class="n">range</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">),</span> <span class="n">log10</span><span class="p">(</span><span class="mf">0.3</span><span class="p">),</span> <span class="n">length</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
<span class="n">bs</span> <span class="o">=</span> <span class="p">[</span><span class="n">RectangularBinning</span><span class="p">(</span><span class="n">ϵ</span><span class="p">)</span> <span class="k">for</span> <span class="n">ϵ</span> <span class="kp">in</span> <span class="n">edgelengts</span><span class="p">]</span>

<span class="n">tes</span> <span class="o">=</span> <span class="n">map</span><span class="p">(</span><span class="n">b</span> <span class="o">-&gt;</span> <span class="n">transferentropy</span><span class="p">(</span><span class="n">embedding_pts</span><span class="p">,</span> <span class="n">vars</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">est</span><span class="p">),</span> <span class="n">bs</span><span class="p">)</span>
</pre></div>

<p><code>tes</code> now contains 15 different values of the transfer entropy, one for each of  the discretization schemes. For the smallest bin sizes, the transfer entropy  is close to or equal to zero, because there are not enough points distributed  among the bins (of which there are many when the box edge length is small).</p>
<p><a id='te_estimation_nn-1'></a></p>
<h2 id="computing-transfer-entropy-by-counting-nearest-neighbors">Computing transfer entropy by counting nearest neighbors</h2>
<p><a id='TransferEntropy.transferentropy-Tuple{Any,TEVars,NearestNeighbourMI}' href='#TransferEntropy.transferentropy-Tuple{Any,TEVars,NearestNeighbourMI}'>#</a>
<strong><code>TransferEntropy.transferentropy</code></strong> &mdash; <em>Method</em>.</p>
<div class="highlight"><pre><span></span><span class="n">transferentropy</span><span class="p">(</span><span class="n">pts</span><span class="p">,</span> <span class="n">vars</span><span class="o">::</span><span class="n">TEVars</span><span class="p">,</span> <span class="n">estimator</span><span class="o">::</span><span class="n">NearestNeighbourMI</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Float64</span>
</pre></div>

<p>Compute the transfer entropy for a set of <code>pts</code>, computing mutual  information (MI) terms using counting of nearest neighbours. </p>
<p>Uses the MI estimator from [1], which was implemented to compute  transfer entropy in [2].</p>
<p><strong>Arguments</strong></p>
<ul>
<li><strong><code>pts</code></strong>: An ordered set of <code>m</code>-dimensional points (<code>pts</code>) representing    an appropriate <a href="../@ref">generalised embedding</a> of some data series. Must be    vector of states, not a vector of variables/time series. Wrap your time    series in a <code>DynamicalSystemsBase.Dataset</code> first if the latter is the case.</li>
<li><strong><code>vars::TEVars</code></strong>: A <a href="./#TransferEntropy.TEVars-Tuple{}"><code>TEVars</code></a> instance specifying how the <code>m</code> different    variables of <code>pts</code> are to be mapped into the marginals required for transfer    entropy computation.</li>
<li><strong><code>estimator::NearestNeighbourMI</code></strong>: An instance of a <a href="../TE_estimators/#TransferEntropy.NearestNeighbourMI"><code>NearestNeighbourMI</code></a>,    estimator, which contains information about the number of nearest neighbours to use,   the distance metric and the base of the logarithm that controls the    unit of the transfer entropy.</li>
</ul>
<p><strong>Returns</strong></p>
<p>A single number that is the transfer entropy estimated over <code>pts</code> by assigning marginals  according to <code>vars</code>, using nearest neighbour counting method [1] to estimate  the necessary mutual information terms [2].</p>
<p><strong>References</strong></p>
<ol>
<li>Kraskov, Alexander, Harald Stögbauer, and Peter Grassberger. "Estimating  mutual information." Physical review E 69.6 (2004): 066138.</li>
<li>Diego, David, Kristian Agasøster Haaga, and Bjarte Hannisdal. "Transfer entropy computation   using the Perron-Frobenius operator." Physical Review E 99.4 (2019): 042212.</li>
</ol>
<p><a id='te_estimation_triang-1'></a></p>
<h2 id="computing-transfer-entropy-from-triangulated-partitions">Computing transfer entropy from triangulated partitions</h2>
<p>Estimators for computing transfer entropy on triangulated partitions, whose invariant distribution is obtained through the transfer operator, was introduced in Diego et al. (2019)<sup id="fnref:2"><a class="footnote-ref" href="#fn:2">1</a></sup>.</p>
<p><a id='TransferEntropy.transferentropy-Tuple{AbstractTriangulationInvariantMeasure,TEVars,RectangularBinning}' href='#TransferEntropy.transferentropy-Tuple{AbstractTriangulationInvariantMeasure,TEVars,RectangularBinning}'>#</a>
<strong><code>TransferEntropy.transferentropy</code></strong> &mdash; <em>Method</em>.</p>
<div class="highlight"><pre><span></span><span class="n">transferentropy</span><span class="p">(</span><span class="n">μ</span><span class="o">::</span><span class="n">AbstractTriangulationInvariantMeasure</span><span class="p">,</span> <span class="n">vars</span><span class="o">::</span><span class="n">TEVars</span><span class="p">,</span>
    <span class="n">binning_scheme</span><span class="o">::</span><span class="n">RectangularBinning</span><span class="p">;</span> 
    <span class="n">estimator</span><span class="o">::</span><span class="n">BinningTransferEntropyEstimator</span> <span class="o">=</span> <span class="n">VisitationFrequency</span><span class="p">(),</span> 
    <span class="n">n</span><span class="o">::</span><span class="kt">Int</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Float64</span>
</pre></div>

<p><strong>Transfer entropy using a precomputed invariant measure over a triangulated partition</strong></p>
<p>Estimate transfer entropy from an invariant measure over a triangulation of  an appropriate <a href="../../causalitytoolsbase/delay_reconstructions/#custom_delay_reconstruction-1">generalised delay reconstruction</a> that has been precomputed either as </p>
<ol>
<li><code>μ = invariantmeasure(pts, TriangulationBinning(), ApproximateIntersection())</code>, or</li>
<li><code>μ = invariantmeasure(pts, TriangulationBinning(), ExactIntersection())</code></li>
</ol>
<p>where the first method uses approximate simplex intersections (faster) and  the second method uses exact simplex intersections (slow). <code>μ</code> contains  all the information needed to compute transfer entropy. </p>
<p>Note: <code>pts</code> must be a vector of states, not a vector of  variables/(time series). Wrap your time series in a <code>Dataset</code> first if the latter is the case.</p>
<p><strong>Computing transfer entropy (triangulation -&gt; rectangular partition)</strong></p>
<p>Because we need to compute marginals, we need a rectangular grid. To do so, transfer entropy is computed by sampling the simplices of the  triangulation according to their measure with a total of approximately  <code>n</code> points. Introducing multiple points as representatives for the partition elements does not introduce any bias, because we in computing the  invariant measure, we use no more information than what is encoded in the  dynamics of the original data points. However, from the invariant measure, we can get a practically infinite amount of points to estimate transfer  entropy from.</p>
<p>Then, transfer entropy is estimated using the visitation  frequency estimator on those points (see docs for <code>transferentropy_visitfreq</code>  for more information), on a rectangular grid specified by <code>binning_scheme</code>.</p>
<p><strong>Common use case</strong></p>
<p>This method is good to use if you want to explore the sensitivity  of transfer entropy to the bin size in the final rectangular grid,  when you have few observations in the time series. The invariant  measure, which encodes the dynamical information, is slow to compute over  the triangulation, but only needs to be computed once. After that, transfer entropy may be estimated at multiple scales very quickly.</p>
<p><strong>Example</strong></p>
<div class="highlight"><pre><span></span><span class="c"># Assume these points are an appropriate delay embedding {(x(t), y(t), y(t+1))} and </span>
<span class="c"># that we&#39;re measure transfer entropy from x -&gt; y. </span>
<span class="n">pts</span> <span class="o">=</span> <span class="n">invariantize</span><span class="p">([</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="o">:</span><span class="mi">30</span><span class="p">])</span>

<span class="n">v</span> <span class="o">=</span> <span class="n">TEVars</span><span class="p">(</span><span class="n">Tf</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">Tpp</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">Spp</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="c"># Compute invariant measure over a triangulation using approximate </span>
<span class="c"># simplex intersections. This is relatively slow.</span>
<span class="n">μ</span> <span class="o">=</span> <span class="n">invariantmeasure</span><span class="p">(</span><span class="n">pts</span><span class="p">,</span> <span class="n">TriangulationBinning</span><span class="p">(),</span> <span class="n">ApproximateIntersection</span><span class="p">())</span>

<span class="c"># Compute transfer entropy from the invariant measure over multiple </span>
<span class="c"># bin sizes. This is fast, because the measure has been precomputed.</span>
<span class="n">tes</span> <span class="o">=</span> <span class="n">map</span><span class="p">(</span><span class="n">ϵ</span> <span class="o">-&gt;</span> <span class="n">transferentropy</span><span class="p">(</span><span class="n">μ</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">RectangularBinning</span><span class="p">(</span><span class="n">ϵ</span><span class="p">)),</span> <span class="mi">2</span><span class="o">:</span><span class="mi">50</span><span class="p">)</span>
</pre></div>

<div class="footnote">
<hr />
<ol>
<li id="fn:2">
<p>Diego, David, Kristian Agasøster Haaga, and Bjarte Hannisdal. "Transfer entropy computation using the Perron-Frobenius operator." Physical Review E 99.4 (2019): 042212.&#160;<a class="footnote-backref" href="#fnref:2" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
</ol>
</div>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../TE_estimators/" title="Estimators" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Estimators
              </span>
            </div>
          </a>
        
        
          <a href="../convenience_methods_te/" title="Convenience methods" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Convenience methods
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.30f6b8b1.js"></script>
      
      <script>app.initialize({version:"0.17.5",url:{base:"../.."}})</script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_HTML"></script>
      
        <script src="../../assets/mathjaxhelper.js"></script>
      
    
    
      
    
  </body>
</html>