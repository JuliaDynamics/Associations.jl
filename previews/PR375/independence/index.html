<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Independence · CausalityTools.jl</title><meta name="title" content="Independence · CausalityTools.jl"/><meta property="og:title" content="Independence · CausalityTools.jl"/><meta property="twitter:title" content="Independence · CausalityTools.jl"/><meta name="description" content="Documentation for CausalityTools.jl."/><meta property="og:description" content="Documentation for CausalityTools.jl."/><meta property="twitter:description" content="Documentation for CausalityTools.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="https://fonts.googleapis.com/css?family=Montserrat|Source+Code+Pro&amp;display=swap" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img class="docs-light-only" src="../assets/logo.png" alt="CausalityTools.jl logo"/><img class="docs-dark-only" src="../assets/logo-dark.png" alt="CausalityTools.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">CausalityTools.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">CausalityTools.jl</a></li><li><span class="tocitem">Core API reference</span><ul><li><a class="tocitem" href="../associations/">Association measures</a></li><li class="is-active"><a class="tocitem" href>Independence</a><ul class="internal"><li><a class="tocitem" href="#Independence-testing-API"><span>Independence testing API</span></a></li><li><a class="tocitem" href="#[SurrogateAssociationTest](@ref)"><span><code>SurrogateAssociationTest</code></span></a></li><li><a class="tocitem" href="#[LocalPermutationTest](@ref)"><span><code>LocalPermutationTest</code></span></a></li><li><a class="tocitem" href="#[JointDistanceDistributionTest](@ref)"><span><code>JointDistanceDistributionTest</code></span></a></li><li><a class="tocitem" href="#[CorrTest](@ref)"><span><code>CorrTest</code></span></a></li></ul></li><li><a class="tocitem" href="../causal_graphs/">Network/graph inference</a></li></ul></li><li><span class="tocitem">Extended API reference</span><ul><li><a class="tocitem" href="../api/discretization_counts_probs_api/">Discretization API</a></li><li><a class="tocitem" href="../api/counts_and_probabilities_api/">Multivariate counts and probabilities API</a></li><li><a class="tocitem" href="../api/information_single_variable_api/">Single-variable information API</a></li><li><a class="tocitem" href="../api/information_multivariate_api/">Multivariate information API</a></li><li><a class="tocitem" href="../api/cross_map_api/">Cross-map API</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../examples/examples_associations/">Associations</a></li><li><a class="tocitem" href="../examples/examples_independence/">Independence testing</a></li><li><a class="tocitem" href="../examples/examples_infer_graphs/">Causal graph inference</a></li></ul></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Core API reference</a></li><li class="is-active"><a href>Independence</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Independence</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaDynamics/CausalityTools.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaDynamics/CausalityTools.jl/blob/main/docs/src/independence.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="independence_testing"><a class="docs-heading-anchor" href="#independence_testing">Independence testing</a><a id="independence_testing-1"></a><a class="docs-heading-anchor-permalink" href="#independence_testing" title="Permalink"></a></h1><p>For practical applications, it is often useful to determine whether variables are independent, possible conditioned upon  another set of variables. One way of doing so is to utilize an  association measure, and perform some sort of randomization-based <a href="#independence_testing">independence testing</a>.</p><p>For example, to test the dependence between time series, <a href="https://github.com/JuliaDynamics/TimeseriesSurrogates.jl">time series surrogates testing</a> is used. Many other frameworks for independence exist too. Here, we&#39;ve collected some independence testing frameworks, and made sure that they are compatible with as many of the implemented association measures as possible.</p><h2 id="Independence-testing-API"><a class="docs-heading-anchor" href="#Independence-testing-API">Independence testing API</a><a id="Independence-testing-API-1"></a><a class="docs-heading-anchor-permalink" href="#Independence-testing-API" title="Permalink"></a></h2><p>The independence test API is defined by</p><ul><li><a href="#CausalityTools.independence"><code>independence</code></a></li><li><a href="#CausalityTools.IndependenceTest"><code>IndependenceTest</code></a></li></ul><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CausalityTools.independence" href="#CausalityTools.independence"><code>CausalityTools.independence</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">independence(test::IndependenceTest, x, y, [z]) → summary</code></pre><p>Perform the given <a href="#CausalityTools.IndependenceTest"><code>IndependenceTest</code></a> <code>test</code> on data <code>x</code>, <code>y</code> and <code>z</code>. If only <code>x</code> and <code>y</code> are given, <code>test</code> must provide a bivariate association measure. If <code>z</code> is given too, then <code>test</code> must provide a conditional association measure.</p><p>Returns a test <code>summary</code>, whose type depends on <code>test</code>.</p><p><strong>Compatible independence tests</strong></p><ul><li><a href="#CausalityTools.SurrogateAssociationTest"><code>SurrogateAssociationTest</code></a></li><li><a href="#CausalityTools.LocalPermutationTest"><code>LocalPermutationTest</code></a></li><li><a href="#CausalityTools.JointDistanceDistributionTest"><code>JointDistanceDistributionTest</code></a></li><li><a href="#CausalityTools.CorrTest"><code>CorrTest</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/CausalityTools.jl/blob/efed0de34c16325619a4cf349ee8bd3cdf8277ec/src/independence_tests/independence.jl#L16-L31">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CausalityTools.IndependenceTest" href="#CausalityTools.IndependenceTest"><code>CausalityTools.IndependenceTest</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">IndependenceTest &lt;: IndependenceTest</code></pre><p>The supertype for all independence tests.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/CausalityTools.jl/blob/efed0de34c16325619a4cf349ee8bd3cdf8277ec/src/independence_tests/independence.jl#L6-L10">source</a></section></article><h2 id="[SurrogateAssociationTest](@ref)"><a class="docs-heading-anchor" href="#[SurrogateAssociationTest](@ref)"><a href="#CausalityTools.SurrogateAssociationTest"><code>SurrogateAssociationTest</code></a></a><a id="[SurrogateAssociationTest](@ref)-1"></a><a class="docs-heading-anchor-permalink" href="#[SurrogateAssociationTest](@ref)" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CausalityTools.SurrogateAssociationTest" href="#CausalityTools.SurrogateAssociationTest"><code>CausalityTools.SurrogateAssociationTest</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">SurrogateAssociationTest &lt;: IndependenceTest
SurrogateAssociationTest(est_or_measure;
    nshuffles::Int = 100,
    surrogate = RandomShuffle(),
    rng = Random.default_rng(),
    show_progress = false,
)</code></pre><p>A surrogate-data based generic (conditional) independence test for assessing whether the  association between variables <code>X</code> and <code>Y</code> are independent, potentially conditioned on a  third variable <code>Z</code>.</p><p><strong>Compatible estimators and measures</strong></p><ul><li>Compatible with <a href="../associations/#CausalityTools.AssociationMeasure"><code>AssociationMeasure</code></a>s that measure some sort of pairwise or conditional association.</li></ul><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>You must yourself determine whether using a particular measure is <em>meaningful</em>, and what it <em>means</em>.</p></div></div><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>If used with a <a href="../associations/#CausalityTools.TransferEntropy"><code>TransferEntropy</code></a> measure such as <a href="../associations/#CausalityTools.TEShannon"><code>TEShannon</code></a>, then the source variable is always shuffled, and the target and conditional variable are left unshuffled.</p></div></div><p><strong>Usage</strong></p><ul><li>Use with <a href="#CausalityTools.independence"><code>independence</code></a> to perform a surrogate test with input data. This will   return a <a href="#CausalityTools.SurrogateAssociationTestResult"><code>SurrogateAssociationTestResult</code></a>.</li></ul><p><strong>Description</strong></p><p>This is a generic one-sided hypothesis test that checks whether <code>x</code> and <code>y</code> are independent (given <code>z</code>, if provided) based on resampling from a null distribution assumed to represent independence between the variables. The null distribution is generated by repeatedly shuffling the input data in some way that is intended to break any dependence between the input variables.</p><p>The test first estimates the desired statistic using <code>est_or_measure</code> on the input data.  Then, the first input variable is shuffled <code>nshuffled</code> times according to the given  <code>surrogate</code> method (each type of <code>surrogate</code> represents a distinct null hypothesis). For each shuffle, <code>est_or_measure</code> is recomputed and the results are stored. </p><p><strong>Examples</strong></p><ul><li><a href="../examples/examples_independence/#example_SurrogateAssociationTest_SMeasure">Example 1</a>:    <a href="../associations/#CausalityTools.SMeasure"><code>SMeasure</code></a> test for pairwise independence.</li><li><a href="../examples/examples_independence/#example_SurrogateAssociationTest_DistanceCorrelation">Example 2</a>:    <a href="../associations/#CausalityTools.DistanceCorrelation"><code>DistanceCorrelation</code></a> test for pairwise independence.</li><li><a href="../examples/examples_independence/#example_SurrogateAssociationTest_PartialCorrelation">Example 3</a>:   <a href="../associations/#CausalityTools.PartialCorrelation"><code>PartialCorrelation</code></a> test for conditional independence.</li><li><a href="../examples/examples_independence/#example_SurrogateAssociationTest_MIShannon_categorical">Example 4</a>:   <a href="../associations/#CausalityTools.MIShannon"><code>MIShannon</code></a> test for pairwise independence on categorical data.</li><li><a href="../examples/examples_independence/#example_SurrogateAssociationTest_CMIShannon_categorical">Example 5</a>:   <a href="../associations/#CausalityTools.CMIShannon"><code>CMIShannon</code></a> test for conditional independence on categorical data.  </li><li><a href="../examples/examples_independence/#example_independence_MCR">Example 6</a>: <a href="../associations/#CausalityTools.MCR"><code>MCR</code></a> test for    pairwise and conditional independence.  </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/CausalityTools.jl/blob/efed0de34c16325619a4cf349ee8bd3cdf8277ec/src/independence_tests/surrogate/SurrogateAssociationTest.jl#L8-L66">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CausalityTools.SurrogateAssociationTestResult" href="#CausalityTools.SurrogateAssociationTestResult"><code>CausalityTools.SurrogateAssociationTestResult</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">SurrogateAssociationTestResult(m, m_surr, pvalue)</code></pre><p>Holds the result of a <a href="#CausalityTools.SurrogateAssociationTest"><code>SurrogateAssociationTest</code></a>. <code>m</code> is the measure computed on the original data. <code>m_surr</code> is a vector of the measure computed on permuted data, where <code>m_surr[i]</code> is the measure compute on the <code>i</code>-th permutation. <code>pvalue</code> is the one-sided <code>p</code>-value for the test.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/CausalityTools.jl/blob/efed0de34c16325619a4cf349ee8bd3cdf8277ec/src/independence_tests/surrogate/SurrogateAssociationTest.jl#L96-L103">source</a></section></article><h2 id="[LocalPermutationTest](@ref)"><a class="docs-heading-anchor" href="#[LocalPermutationTest](@ref)"><a href="#CausalityTools.LocalPermutationTest"><code>LocalPermutationTest</code></a></a><a id="[LocalPermutationTest](@ref)-1"></a><a class="docs-heading-anchor-permalink" href="#[LocalPermutationTest](@ref)" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CausalityTools.LocalPermutationTest" href="#CausalityTools.LocalPermutationTest"><code>CausalityTools.LocalPermutationTest</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">LocalPermutationTest &lt;: IndependenceTest
LocalPermutationTest(measure, [est];
    kperm::Int = 5,
    nshuffles::Int = 100,
    rng = Random.default_rng(),
    replace = true,
    w::Int = 0,
    show_progress = false)</code></pre><p><code>LocalPermutationTest</code> is a generic conditional independence test (<a href="../references/#Runge2018LocalPerm">Runge, 09–11 Apr 2018</a>) for assessing whether two variables <code>X</code> and <code>Y</code> are conditionally independendent given a third variable <code>Z</code> (all of which may be multivariate).</p><p>When used with <a href="#CausalityTools.independence"><code>independence</code></a>, a <a href="#CausalityTools.LocalPermutationTestResult"><code>LocalPermutationTestResult</code></a> is returned.</p><p><strong>Description</strong></p><p>This is a generic one-sided hypothesis test that checks whether <code>X</code> and <code>Y</code> are independent (given <code>Z</code>, if provided) based on resampling from a null distribution assumed to represent independence between the variables. The null distribution is generated by repeatedly shuffling the input data in some way that is intended to break any dependence between <code>x</code> and <code>y</code>, but preserve dependencies between <code>x</code> and <code>z</code>.</p><p>The algorithm is as follows:</p><ol><li>Compute the original conditional independence statistic <code>I(X; Y | Z)</code>.</li><li>Allocate a scalar valued vector <code>Î</code> with space for <code>nshuffles</code> elements.</li><li>For <code>k ∈ [1, 2, …, nshuffles]</code>, repeat<ul><li>For each <code>zᵢ ∈ Y</code>, let <code>nᵢ</code> be time indices of the <code>kperm</code> nearest neighbors of <code>zᵢ</code>,   excluding the <code>w</code> nearest neighbors of <code>zᵢ</code> from the neighbor query (i.e <code>w</code> is   the Theiler window).</li><li>Let <code>xᵢ⋆ = X[j]</code>, where <code>j</code> is randomly sampled from <code>nᵢ</code> with replacement.   This way, <code>xᵢ</code> is replaced with <code>xⱼ</code> only if <code>zᵢ ≈ zⱼ</code> (<code>zᵢ</code> and <code>zⱼ</code> are close).   Repeat for <code>i = 1, 2, …, n</code> and obtain the shuffled <code>X̂ = [x̂₁, x̂₂, …, x̂ₙ]</code>.</li><li>Compute the conditional independence statistic <code>Iₖ(X̂; Y | Z)</code>.</li><li>Let <code>Î[k] = Iₖ(X̂; Y | Z)</code>.</li></ul></li><li>Compute the p-value as <code>count(Î[k] .&lt;= I) / nshuffles)</code>.</li></ol><p>In additional to the conditional variant from Runge (2018), we also provide a pairwise version, where the shuffling procedure is identical, except neighbors in <code>Y</code> are used instead of <code>Z</code> and we <code>I(X; Y)</code> and <code>Iₖ(X̂; Y)</code> instead of <code>I(X; Y | Z)</code> and <code>Iₖ(X̂; Y | Z)</code>.</p><p><strong>Compatible measures</strong></p><table><tr><th style="text-align: right">Measure</th><th style="text-align: center">Pairwise</th><th style="text-align: center">Conditional</th><th style="text-align: center">Requires <code>est</code></th><th style="text-align: center">Note</th></tr><tr><td style="text-align: right"><a href="../associations/#CausalityTools.PartialCorrelation"><code>PartialCorrelation</code></a></td><td style="text-align: center">✖</td><td style="text-align: center">✓</td><td style="text-align: center">No</td><td style="text-align: center"></td></tr><tr><td style="text-align: right"><a href="../associations/#CausalityTools.DistanceCorrelation"><code>DistanceCorrelation</code></a></td><td style="text-align: center">✖</td><td style="text-align: center">✓</td><td style="text-align: center">No</td><td style="text-align: center"></td></tr><tr><td style="text-align: right"><a href="../associations/#CausalityTools.CMIShannon"><code>CMIShannon</code></a></td><td style="text-align: center">✖</td><td style="text-align: center">✓</td><td style="text-align: center">Yes</td><td style="text-align: center"></td></tr><tr><td style="text-align: right"><a href="../associations/#CausalityTools.TEShannon"><code>TEShannon</code></a></td><td style="text-align: center">✓</td><td style="text-align: center">✓</td><td style="text-align: center">Yes</td><td style="text-align: center">Pairwise tests not possible with <code>TransferEntropyEstimator</code>s, only lower-level estimators, e.g. <code>FPVP</code>, <code>GaussianMI</code> or <code>Kraskov</code></td></tr><tr><td style="text-align: right"><a href="../associations/#CausalityTools.PartialMutualInformation"><code>PartialMutualInformation</code></a></td><td style="text-align: center">✖</td><td style="text-align: center">✓</td><td style="text-align: center">Yes</td><td style="text-align: center"></td></tr></table><p>The <code>LocalPermutationTest</code> is only defined for conditional independence testing. Exceptions are for measures like <a href="../associations/#CausalityTools.TEShannon"><code>TEShannon</code></a>, which use conditional measures under the hood even for their pairwise variants, and are therefore compatible with <code>LocalPermutationTest</code>.</p><p>The nearest-neighbor approach in Runge (2018) can be reproduced by using the <a href="../associations/#CausalityTools.CMIShannon"><code>CMIShannon</code></a> measure with the <a href="../api/information_multivariate_api/#CausalityTools.FPVP"><code>FPVP</code></a> estimator.</p><p><strong>Examples</strong></p><ul><li><a href="../examples/examples_independence/#example_LocalPermutationTest_CMIShannon">Example 1</a>:   Conditional independence test using <a href="../associations/#CausalityTools.CMIShannon"><code>CMIShannon</code></a></li><li><a href="../examples/examples_independence/#example_LocalPermutationTest_TEShannon">Example 2</a>):    Conditional independence test using <a href="../associations/#CausalityTools.TEShannon"><code>TEShannon</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/CausalityTools.jl/blob/efed0de34c16325619a4cf349ee8bd3cdf8277ec/src/independence_tests/local_permutation/LocalPermutationTest.jl#L31-L99">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CausalityTools.LocalPermutationTestResult" href="#CausalityTools.LocalPermutationTestResult"><code>CausalityTools.LocalPermutationTestResult</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">LocalPermutationTestResult(m, m_surr, pvalue)</code></pre><p>Holds the result of a <a href="#CausalityTools.LocalPermutationTest"><code>LocalPermutationTest</code></a>. <code>m</code> is the measure computed on the original data. <code>m_surr</code> is a vector of the measure computed on permuted data, where <code>m_surr[i]</code> is the measure compute on the <code>i</code>-th permutation. <code>pvalue</code> is the one-sided <code>p</code>-value for the test.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/CausalityTools.jl/blob/efed0de34c16325619a4cf349ee8bd3cdf8277ec/src/independence_tests/local_permutation/LocalPermutationTest.jl#L131-L138">source</a></section></article><h2 id="[JointDistanceDistributionTest](@ref)"><a class="docs-heading-anchor" href="#[JointDistanceDistributionTest](@ref)"><a href="#CausalityTools.JointDistanceDistributionTest"><code>JointDistanceDistributionTest</code></a></a><a id="[JointDistanceDistributionTest](@ref)-1"></a><a class="docs-heading-anchor-permalink" href="#[JointDistanceDistributionTest](@ref)" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CausalityTools.JointDistanceDistributionTest" href="#CausalityTools.JointDistanceDistributionTest"><code>CausalityTools.JointDistanceDistributionTest</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">JointDistanceDistributionTest &lt;: IndependenceTest
JointDistanceDistributionTest(measure::JointDistanceDistribution; rng = Random.default_rng())</code></pre><p>An independence test for two variables based on the <a href="../associations/#CausalityTools.JointDistanceDistribution"><code>JointDistanceDistribution</code></a> (<a href="../references/#Amigo2018">Amigó and Hirata, 2018</a>).</p><p>When used with <a href="#CausalityTools.independence"><code>independence</code></a>, a <a href="#CausalityTools.JDDTestResult"><code>JDDTestResult</code></a> is returned.</p><p><strong>Description</strong></p><p>The joint distance distribution (labelled <code>Δ</code> in their paper) is used by Amigó &amp; Hirata (2018) to detect directional couplings of the form <span>$X \to Y$</span> or <span>$Y \to X$</span>. <code>JointDistanceDistributionTest</code> formulates their method as an independence test.</p><p>Formally, we test the hypothesis <span>$H_0$</span> (the variables are independent) against <span>$H_1$</span> (there is directional coupling between the variables). To do so, we use a right-sided/upper-tailed t-test to check mean of <code>Δ</code> is skewed towards positive value, i.e.</p><ul><li><span>$H_0 := \mu(\Delta) = 0$</span></li><li><span>$H_1 := \mu(\Delta) &gt; 0$</span>.</li></ul><p>When used with <a href="#CausalityTools.independence"><code>independence</code></a>, a <code>JDDTestResult</code> is returned, which contains the joint distance distribution and a p-value. If you only need <code>Δ</code>, use <a href="../associations/#CausalityTools.association"><code>association</code></a>  with a <a href="../associations/#CausalityTools.JointDistanceDistribution"><code>JointDistanceDistribution</code></a> instance directly.</p><p><strong>Examples</strong></p><ul><li><a href="../examples/examples_independence/#examples_independence_JointDistanceDistributionTest">Example 1</a>. Detecting (in)dependence   in bidirectionally coupled logistic maps.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/CausalityTools.jl/blob/efed0de34c16325619a4cf349ee8bd3cdf8277ec/src/independence_tests/parametric/JointDistanceDistributionTest.jl#L8-L38">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CausalityTools.JDDTestResult" href="#CausalityTools.JDDTestResult"><code>CausalityTools.JDDTestResult</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">JDDTestResult(Δjdd, hypothetical_μ, pvalue)</code></pre><p>Holds the results of <a href="#CausalityTools.JointDistanceDistributionTest"><code>JointDistanceDistributionTest</code></a>. <code>Δjdd</code> is the <code>Δ</code>-distribution, <code>hypothetical_μ</code> is the hypothetical mean of the <code>Δ</code>-distribution under the null, and <code>pvalue</code> is the p-value for the one-sided t-test.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/CausalityTools.jl/blob/efed0de34c16325619a4cf349ee8bd3cdf8277ec/src/independence_tests/parametric/JointDistanceDistributionTest.jl#L53-L59">source</a></section></article><h2 id="[CorrTest](@ref)"><a class="docs-heading-anchor" href="#[CorrTest](@ref)"><a href="#CausalityTools.CorrTest"><code>CorrTest</code></a></a><a id="[CorrTest](@ref)-1"></a><a class="docs-heading-anchor-permalink" href="#[CorrTest](@ref)" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CausalityTools.CorrTest" href="#CausalityTools.CorrTest"><code>CausalityTools.CorrTest</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">CorrTest &lt;: IndependenceTest
CorrTest()</code></pre><p>An independence test based correlation (for two variables) and partial correlation (for three variables) (<a href="../references/#Levy1978">Levy and Narula, 1978</a>); as described in <a href="../references/#Schmidt2018">Schmidt <em>et al.</em> (2018)</a>.</p><p>Uses <a href="../associations/#CausalityTools.PearsonCorrelation"><code>PearsonCorrelation</code></a> and <a href="../associations/#CausalityTools.PartialCorrelation"><code>PartialCorrelation</code></a> internally.</p><p>Assumes that the input data are (multivariate) normally distributed. Then <code>ρ(X, Y) = 0</code> implies <code>X ⫫ Y</code> and <code>ρ(X, Y | 𝐙) = 0</code> implies <code>X ⫫ Y | 𝐙</code>.</p><p><strong>Description</strong></p><p>The null hypothesis is <code>H₀ := ρ(X, Y | 𝐙) = 0</code>. We use the approach in Levy &amp; Narula (1978)(<a href="../references/#Levy1978">Levy and Narula, 1978</a>) and compute the Z-transformation of the observed (partial) correlation coefficient <span>$\hat{\rho}_{XY|\bf{Z}}$</span>:</p><p class="math-container">\[Z(\hat{\rho}_{XY|\bf{Z}}) =
\log\dfrac{1 + \hat{\rho}_{XY|\bf{Z}}}{1 - \hat{\rho}_{XY|\bf{Z}}}.\]</p><p>To test the null hypothesis against the alternative hypothesis <code>H₁ := ρ(X, Y | 𝐙) &gt; 0</code>, calculate</p><p class="math-container">\[\hat{Z} = \dfrac{1}{2}\dfrac{Z(\hat{\rho}_{XY|\bf{Z}}) - Z(0)}{\sqrt{1/(n - d - 3)}},\]</p><p>and compute the two-sided p-value (Schmidt et al., 2018)</p><p class="math-container">\[p(X, Y | \bf{Z}) = 2(1 - \phi(\sqrt{n - d - 3}Z(\hat{\rho}_{XY|\bf{Z}}))),\]</p><p>where <span>$d$</span> is the dimension of <span>$\bf{Z}$</span> and <span>$n$</span> is the number of samples. For the pairwise case, the procedure is identical, but set <span>$\bf{Z} = \emptyset$</span>.</p><p><strong>Examples</strong></p><ul><li><a href="../examples/examples_independence/#example_CorrTest">Example 1</a>. Pairwise and conditional tests for independence   on coupled noise processes.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/CausalityTools.jl/blob/efed0de34c16325619a4cf349ee8bd3cdf8277ec/src/independence_tests/parametric/CorrTest.jl#L11-L55">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CausalityTools.CorrTestResult" href="#CausalityTools.CorrTestResult"><code>CausalityTools.CorrTestResult</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">CorrTestResult(pvalue, ρ, z)</code></pre><p>A simple struct that holds the results of a <a href="#CausalityTools.CorrTest"><code>CorrTest</code></a> test: the (partial) correlation coefficient <code>ρ</code>, Fisher&#39;s <code>z</code>, and <code>pvalue</code> - the two-sided p-value for the test.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/CausalityTools.jl/blob/efed0de34c16325619a4cf349ee8bd3cdf8277ec/src/independence_tests/parametric/CorrTest.jl#L60-L66">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../associations/">« Association measures</a><a class="docs-footer-nextpage" href="../causal_graphs/">Network/graph inference »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Friday 26 July 2024 11:23">Friday 26 July 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body><div data-docstringscollapsed="true"></div></html>
