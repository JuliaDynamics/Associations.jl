<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Independence testing · CausalityTools.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="https://fonts.googleapis.com/css?family=Montserrat|Source+Code+Pro&amp;display=swap" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="CausalityTools.jl logo"/></a><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Overview</a></li><li><a class="tocitem" href="../correlation_measures/">Correlation measures</a></li><li><span class="tocitem">Information measures</span><ul><li><a class="tocitem" href="../probabilities/">Probability mass functions</a></li><li><a class="tocitem" href="../entropy/">Entropy</a></li><li><a class="tocitem" href="../entropy_conditional/">Conditional entropy</a></li><li><a class="tocitem" href="../mutualinfo/">Mutual information</a></li><li><a class="tocitem" href="../condmutualinfo/">Conditional mutual information</a></li><li><a class="tocitem" href="../transferentropy/">Transfer entropy</a></li></ul></li><li><a class="tocitem" href="../cross_mappings/">Cross mappings</a></li><li><a class="tocitem" href="../jdd/">Joint distance distribution</a></li><li class="is-active"><a class="tocitem" href>Independence testing</a><ul class="internal"><li><a class="tocitem" href="#Independence-test-API"><span>Independence test API</span></a></li><li><a class="tocitem" href="#Independence-tests"><span>Independence tests</span></a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><input class="collapse-toggle" id="menuitem-7-1" type="checkbox"/><label class="tocitem" for="menuitem-7-1"><span class="docs-label">Quickstart</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../quickstart/quickstart_mi/">Mutual information</a></li><li><a class="tocitem" href="../quickstart/quickstart_independence/">Independence testing</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-7-2" type="checkbox"/><label class="tocitem" for="menuitem-7-2"><span class="docs-label">Longer examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../examples/examples_entropy/">Entropy</a></li><li><a class="tocitem" href="../examples/examples_conditional_entropy/">Conditional entropy</a></li><li><a class="tocitem" href="../examples/examples_mutualinfo/">Mutual information</a></li><li><a class="tocitem" href="../examples/examples_transferentropy/">Transfer entropy</a></li><li><a class="tocitem" href="../examples/examples_cross_mappings/">Cross mappings</a></li><li><a class="tocitem" href="../examples/examples_independence/">Independence testing</a></li></ul></li></ul></li><li><a class="tocitem" href="../experimental/">Experimental</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Independence testing</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Independence testing</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaDynamics/CausalityTools.jl/blob/master/docs/src/independence.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Independence-testing"><a class="docs-heading-anchor" href="#Independence-testing">Independence testing</a><a id="Independence-testing-1"></a><a class="docs-heading-anchor-permalink" href="#Independence-testing" title="Permalink"></a></h1><p>A common application of information theoretic methods such as conditional mutual information (<a href="../condmutualinfo/#CausalityTools.condmutualinfo-Tuple{ConditionalMutualInformationEstimator, Any, Any, Any}"><code>condmutualinfo</code></a>) is in the context of null hypothesis testing for the conditional independence of variables.</p><p>Depending on the context, the input data and the method used, there are many considerations to be made about how to perform this conditional independence testing. Luckily, many excellent frameworks for doing so exist in the literature.</p><p>Here, we present some commonly used independence tests from the scientific literature, which can all be seamlessly used with the function <a href="#CausalityTools.independence"><code>independence</code></a>, with <em>any</em> measure that quantifies conditional independence, in combination with <em>any</em> compatible estimator.</p><p>For example, in just a few lines of code, you can perform Runge&#39;s local permutation (<a href="#CausalityTools.LocalPermutationTest"><code>LocalPermutationTest</code></a> test on your data with <em>over 20 different estimators</em> for the conditional mutual information. If your application rather calls for the use of traditional <a href="https://github.com/JuliaDynamics/TimeseriesSurrogates.jl">surrogate data</a>, the <a href="#CausalityTools.SurrogateTest"><code>SurrogateTest</code></a> test seamlessly integrates with any time series surrogate method from TimeseriesSurrogates.jl.</p><h2 id="Independence-test-API"><a class="docs-heading-anchor" href="#Independence-test-API">Independence test API</a><a id="Independence-test-API-1"></a><a class="docs-heading-anchor-permalink" href="#Independence-test-API" title="Permalink"></a></h2><p>The independence test API is defined by</p><ul><li><a href="#CausalityTools.independence"><code>independence</code></a></li><li><a href="@ref"><code>IndependenceTest</code></a></li><li><a href="@ref"><code>ConditionalIndependenceTest</code></a></li></ul><article class="docstring"><header><a class="docstring-binding" id="CausalityTools.independence" href="#CausalityTools.independence"><code>CausalityTools.independence</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">independence(test::IndependenceTest, x, y, [z]) → summary</code></pre><p>Perform the given <a href="@ref"><code>IndependenceTest</code></a> <code>test</code> on data <code>x</code>, <code>y</code> and <code>z</code>. If only <code>x</code> and <code>y</code> are given, <code>test</code> must provide a bivariate association measure. If <code>z</code> is given too, then <code>test</code> must provide a conditional association measure.</p><p>Returns a test <code>summary</code>, whose type depends on <code>test</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/CausalityTools.jl/blob/589f1d5529a24596a6e5529ba538799fdb3bf175/src/independence_tests/independence.jl#L12-L20">source</a></section></article><h2 id="Independence-tests"><a class="docs-heading-anchor" href="#Independence-tests">Independence tests</a><a id="Independence-tests-1"></a><a class="docs-heading-anchor-permalink" href="#Independence-tests" title="Permalink"></a></h2><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>ConditionalIndependenceTest</code>. Check Documenter&#39;s build log for details.</p></div></div><h3 id="Surrogate-test-(global-permutation)"><a class="docs-heading-anchor" href="#Surrogate-test-(global-permutation)">Surrogate test (global permutation)</a><a id="Surrogate-test-(global-permutation)-1"></a><a class="docs-heading-anchor-permalink" href="#Surrogate-test-(global-permutation)" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="CausalityTools.SurrogateTest" href="#CausalityTools.SurrogateTest"><code>CausalityTools.SurrogateTest</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">SurrogateTest &lt;: IndependenceTest
SurrogateTest(measure, [est];
    nshuffles::Int = 100,
    surrogate = RandomShuffle(),
    rng = Random.default_rng(),
)</code></pre><p>A generic (conditional) independence test for assessing whether two variables <code>X</code> and <code>Y</code> are independendent, potentially conditioned on a third variable <code>Z</code>, based on surrogate data. Used with <a href="#CausalityTools.independence"><code>independence</code></a>.</p><p><strong>Description</strong></p><p>This is a generic one-sided hypothesis test that checks whether <code>x</code> and <code>y</code> are independent (given <code>z</code>, if provided) based on resampling from a null distribution assumed to represent independence between the variables. The null distribution is generated by repeatedly shuffling the input data in some way that is intended to break any dependence between the input variables.</p><p>There are different ways of shuffling, dictated by <code>surrogate</code>, each representing a distinct null hypothesis. For each shuffle, the provided <code>measure</code> is computed (using <code>est</code>, if relevant). This procedure is repeated <code>nshuffles</code> times, and a test summary is returned.</p><p>For bivariate measures, the default is to shuffle both input variables. For conditional measures accepting three input variables, the default is to shuffle the first input. Exceptions are:</p><ul><li>If <a href="../transferentropy/#CausalityTools.TransferEntropy"><code>TransferEntropy</code></a> measure such as <a href="../transferentropy/#CausalityTools.TEShannon"><code>TEShannon</code></a>,   then the source variable is always shuffled, and the target and conditional   variable are left unshuffled.</li></ul><p><strong>Examples</strong></p><ul><li><a href="../quickstart/quickstart_independence/#quickstart_surrogatetest">Quickstart examples</a>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/CausalityTools.jl/blob/589f1d5529a24596a6e5529ba538799fdb3bf175/src/independence_tests/surrogate/SurrogateTest.jl#L6-L41">source</a></section></article><h3 id="Local-permutation"><a class="docs-heading-anchor" href="#Local-permutation">Local permutation</a><a id="Local-permutation-1"></a><a class="docs-heading-anchor-permalink" href="#Local-permutation" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="CausalityTools.LocalPermutationTest" href="#CausalityTools.LocalPermutationTest"><code>CausalityTools.LocalPermutationTest</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">LocalPermutationTest &lt;: IndependenceTest
LocalPermutationTest(measure, [est];
    kperm::Int = 5,
    nshuffles::Int = 100,
    rng = Random.default_rng())</code></pre><p><code>LocalPermutationTest</code> is a generic conditional independence test (Runge, 2018)<sup class="footnote-reference"><a id="citeref-Runge2018" href="#footnote-Runge2018">[Runge2018]</a></sup> for assessing whether two variables <code>X</code> and <code>Y</code> are conditionally independendent given a third variable <code>Z</code> (all of which may be multivariate).</p><p>Any association <code>measure</code> (with a compatible estimator <code>est</code>, if relevant) with ordering <span>$\hat{M}(X; Y | Z)$</span> (conditional variable is the third) can be used. To obtain the nearest-neighbor approach in Runge, 2018, use the <a href="../condmutualinfo/#CausalityTools.CMIShannon"><code>CMIShannon</code></a> measure with the <a href="../condmutualinfo/#CausalityTools.FPVP"><code>FPVP</code></a> estimator.</p><p><strong>Description</strong></p><p>This is a generic one-sided hypothesis test that checks whether <code>x</code> and <code>y</code> are independent (given <code>z</code>, if provided) based on resampling from a null distribution assumed to represent independence between the variables. The null distribution is generated by repeatedly shuffling the input data in some way that is intended to break any dependence between the input variables.</p><p>For each shuffle, the provided <code>measure</code> is computed (using <code>est</code>, if relevant) while keeping <code>Y</code> and <code>Z</code> fixed, but permuting <code>X</code>, i.e. <span>$\hat{M}(\hat{X}; Y | Z)$</span>. Each shuffle of <code>X</code> is done conditional on <code>Z</code>, such that <code>xᵢ</code> is replaced with <code>xⱼ</code> only if <code>zᵢ ≈ zⱼ</code>, i.e. <code>zᵢ</code> and <code>zⱼ</code> are close. Closeness is determined by a <code>kperm</code>-th nearest neighbor search among the points in <code>Z</code>, and permuted points are constructed as <span>$(x_i^*, y_i, z_i)_{i=1}^N$</span>, where the goal is that <span>$x_i^*$</span> are drawn without replacement, and <span>$x_i$</span> is replaced by <span>$x_j$</span> only if <span>$z_i \approx z_j$</span>. This procedure is repeated <code>nshuffles</code> times, and a test summary is returned.</p><p><strong>Examples</strong></p><p>See <a href="../quickstart/quickstart_independence/#quickstart_localpermutationtest">quickstart examples</a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/CausalityTools.jl/blob/589f1d5529a24596a6e5529ba538799fdb3bf175/src/independence_tests/local_permutation/LocalPermutationTest.jl#L30-L72">source</a></section></article><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-Runge2018"><a class="tag is-link" href="#citeref-Runge2018">Runge2018</a>Runge, J. (2018, March). Conditional independence testing based on a nearest-neighbor estimator of conditional mutual information. In International Conference on Artificial Intelligence and Statistics (pp. 938-947). PMLR.</li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../jdd/">« Joint distance distribution</a><a class="docs-footer-nextpage" href="../quickstart/quickstart_mi/">Mutual information »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Thursday 2 February 2023 15:30">Thursday 2 February 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
