<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Independence testing · CausalityTools.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="https://fonts.googleapis.com/css?family=Montserrat|Source+Code+Pro&amp;display=swap" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img class="docs-light-only" src="../assets/logo.png" alt="CausalityTools.jl logo"/><img class="docs-dark-only" src="../assets/logo-dark.png" alt="CausalityTools.jl logo"/></a><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Overview</a></li><li><a class="tocitem" href="../measures/">Association measures</a></li><li class="is-active"><a class="tocitem" href>Independence testing</a><ul class="internal"><li><a class="tocitem" href="#Independence-testing-API"><span>Independence testing API</span></a></li><li><a class="tocitem" href="#[SurrogateTest](@ref)"><span><code>SurrogateTest</code></span></a></li><li><a class="tocitem" href="#[LocalPermutationTest](@ref)"><span><code>LocalPermutationTest</code></span></a></li><li><a class="tocitem" href="#[JointDistanceDistributionTest](@ref)"><span><code>JointDistanceDistributionTest</code></span></a></li></ul></li><li><a class="tocitem" href="../api/">APIs and estimators</a></li><li><a class="tocitem" href="../examples/">Examples</a></li><li><a class="tocitem" href="../experimental/">Experimental</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Independence testing</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Independence testing</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaDynamics/CausalityTools.jl/blob/master/docs/src/independence.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="independence_testing"><a class="docs-heading-anchor" href="#independence_testing">Independence testing</a><a id="independence_testing-1"></a><a class="docs-heading-anchor-permalink" href="#independence_testing" title="Permalink"></a></h1><h2 id="Independence-testing-API"><a class="docs-heading-anchor" href="#Independence-testing-API">Independence testing API</a><a id="Independence-testing-API-1"></a><a class="docs-heading-anchor-permalink" href="#Independence-testing-API" title="Permalink"></a></h2><p>The independence test API is defined by</p><ul><li><a href="#CausalityTools.independence"><code>independence</code></a></li><li><a href="#CausalityTools.IndependenceTest"><code>IndependenceTest</code></a></li></ul><article class="docstring"><header><a class="docstring-binding" id="CausalityTools.independence" href="#CausalityTools.independence"><code>CausalityTools.independence</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">independence(test::IndependenceTest, x, y, [z]) → summary</code></pre><p>Perform the given <a href="#CausalityTools.IndependenceTest"><code>IndependenceTest</code></a> <code>test</code> on data <code>x</code>, <code>y</code> and <code>z</code>. If only <code>x</code> and <code>y</code> are given, <code>test</code> must provide a bivariate association measure. If <code>z</code> is given too, then <code>test</code> must provide a conditional association measure.</p><p>Returns a test <code>summary</code>, whose type depends on <code>test</code>.</p><p><strong>Compatible independence tests</strong></p><ul><li><a href="#CausalityTools.SurrogateTest"><code>SurrogateTest</code></a>.</li><li><a href="#CausalityTools.LocalPermutationTest"><code>LocalPermutationTest</code></a>.</li><li><a href="#CausalityTools.JointDistanceDistributionTest"><code>JointDistanceDistributionTest</code></a>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/CausalityTools.jl/blob/3ee72504059458ef2c630f102bcd936fd022f804/src/independence_tests/independence.jl#L12-L26">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CausalityTools.IndependenceTest" href="#CausalityTools.IndependenceTest"><code>CausalityTools.IndependenceTest</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">IndependenceTest &lt;: IndependenceTest</code></pre><p>The supertype for all independence tests.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/CausalityTools.jl/blob/3ee72504059458ef2c630f102bcd936fd022f804/src/independence_tests/independence.jl#L5-L9">source</a></section></article><h2 id="[SurrogateTest](@ref)"><a class="docs-heading-anchor" href="#[SurrogateTest](@ref)"><a href="#CausalityTools.SurrogateTest"><code>SurrogateTest</code></a></a><a id="[SurrogateTest](@ref)-1"></a><a class="docs-heading-anchor-permalink" href="#[SurrogateTest](@ref)" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="CausalityTools.SurrogateTest" href="#CausalityTools.SurrogateTest"><code>CausalityTools.SurrogateTest</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">SurrogateTest &lt;: IndependenceTest
SurrogateTest(measure, [est];
    nshuffles::Int = 100,
    surrogate = RandomShuffle(),
    rng = Random.default_rng(),
)</code></pre><p>A generic (conditional) independence test for assessing whether two variables <code>X</code> and <code>Y</code> are independendent, potentially conditioned on a third variable <code>Z</code>, based on surrogate data. Used with <a href="#CausalityTools.independence"><code>independence</code></a>.</p><p><strong>Description</strong></p><p>This is a generic one-sided hypothesis test that checks whether <code>x</code> and <code>y</code> are independent (given <code>z</code>, if provided) based on resampling from a null distribution assumed to represent independence between the variables. The null distribution is generated by repeatedly shuffling the input data in some way that is intended to break any dependence between the input variables.</p><p>There are different ways of shuffling, dictated by <code>surrogate</code>, each representing a distinct null hypothesis. For each shuffle, the provided <code>measure</code> is computed (using <code>est</code>, if relevant). This procedure is repeated <code>nshuffles</code> times, and a test summary is returned. For bivariate measures, the default is to shuffle both input variables. For conditional measures accepting three input variables, the default is to shuffle the first input. Exceptions are:</p><ul><li>If <a href="../api/api_transferentropy/#CausalityTools.TransferEntropy"><code>TransferEntropy</code></a> measure such as <a href="../measures/#CausalityTools.TEShannon"><code>TEShannon</code></a>,   then the source variable is always shuffled, and the target and conditional   variable are left unshuffled.</li></ul><p><strong>Compatible measures</strong></p><table><tr><th style="text-align: right">Measure</th><th style="text-align: center">Pairwise</th><th style="text-align: center">Conditional</th><th style="text-align: center">Requires <code>est</code></th></tr><tr><td style="text-align: right"><a href="../measures/#CausalityTools.PearsonCorrelation"><code>PearsonCorrelation</code></a></td><td style="text-align: center">✓</td><td style="text-align: center">✖</td><td style="text-align: center">No</td></tr><tr><td style="text-align: right"><a href="../measures/#CausalityTools.DistanceCorrelation"><code>DistanceCorrelation</code></a></td><td style="text-align: center">✓</td><td style="text-align: center">✖</td><td style="text-align: center">No</td></tr><tr><td style="text-align: right"><a href="../measures/#CausalityTools.SMeasure"><code>SMeasure</code></a></td><td style="text-align: center">✓</td><td style="text-align: center">✖</td><td style="text-align: center">No</td></tr><tr><td style="text-align: right"><a href="../measures/#CausalityTools.PairwiseAsymmetricInference"><code>PairwiseAsymmetricInference</code></a></td><td style="text-align: center">✓</td><td style="text-align: center">✖</td><td style="text-align: center">Yes</td></tr><tr><td style="text-align: right"><a href="../measures/#CausalityTools.ConvergentCrossMapping"><code>ConvergentCrossMapping</code></a></td><td style="text-align: center">✓</td><td style="text-align: center">✖</td><td style="text-align: center">Yes</td></tr><tr><td style="text-align: right"><a href="../measures/#CausalityTools.MIShannon"><code>MIShannon</code></a></td><td style="text-align: center">✓</td><td style="text-align: center">✖</td><td style="text-align: center">Yes</td></tr><tr><td style="text-align: right"><a href="../measures/#CausalityTools.MIRenyiJizba"><code>MIRenyiJizba</code></a></td><td style="text-align: center">✓</td><td style="text-align: center">✖</td><td style="text-align: center">Yes</td></tr><tr><td style="text-align: right"><a href="../measures/#CausalityTools.MIRenyiSarbu"><code>MIRenyiSarbu</code></a></td><td style="text-align: center">✓</td><td style="text-align: center">✖</td><td style="text-align: center">Yes</td></tr><tr><td style="text-align: right"><a href="../measures/#CausalityTools.MITsallisMartin"><code>MITsallisMartin</code></a></td><td style="text-align: center">✓</td><td style="text-align: center">✖</td><td style="text-align: center">Yes</td></tr><tr><td style="text-align: right"><a href="../measures/#CausalityTools.MITsallisFuruichi"><code>MITsallisFuruichi</code></a></td><td style="text-align: center">✓</td><td style="text-align: center">✖</td><td style="text-align: center">Yes</td></tr><tr><td style="text-align: right"><a href="../measures/#CausalityTools.PartialCorrelation"><code>PartialCorrelation</code></a></td><td style="text-align: center">✖</td><td style="text-align: center">✓</td><td style="text-align: center">Yes</td></tr><tr><td style="text-align: right"><a href="../measures/#CausalityTools.CMIShannon"><code>CMIShannon</code></a></td><td style="text-align: center">✖</td><td style="text-align: center">✓</td><td style="text-align: center">Yes</td></tr><tr><td style="text-align: right"><a href="../measures/#CausalityTools.CMIRenyiJizba"><code>CMIRenyiJizba</code></a></td><td style="text-align: center">✖</td><td style="text-align: center">✓</td><td style="text-align: center">Yes</td></tr><tr><td style="text-align: right"><a href="../api/api_transferentropy/#CausalityTools.TransferEntropy"><code>TransferEntropy</code></a></td><td style="text-align: center">✓</td><td style="text-align: center">✓</td><td style="text-align: center">Yes</td></tr></table><p><strong>Examples</strong></p><ul><li><a href="../examples/examples_independence/#examples_surrogatetest_distancecorrelation">Pairwise test, <code>DistanceCorrelation</code></a>.</li><li><a href="../examples/examples_independence/#examples_surrogatetest_teshannon">Pairwise test, <code>TEShannon</code></a>.</li><li><a href="../examples/examples_independence/#examples_surrogatetest_partialcorrelation">Conditional test, <code>PartialCorrelation</code></a>.</li><li><a href="../examples/examples_independence/#examples_surrogatetest_mishannon_categorical">Pairwise test, <code>MIShannon</code>, categorical</a>.</li><li><a href="../examples/examples_independence/#examples_surrogatetest_cmishannon_categorical">Conditional test, <code>CMIShannon</code>, categorical</a>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/CausalityTools.jl/blob/3ee72504059458ef2c630f102bcd936fd022f804/src/independence_tests/surrogate/SurrogateTest.jl#L6-L63">source</a></section></article><h2 id="[LocalPermutationTest](@ref)"><a class="docs-heading-anchor" href="#[LocalPermutationTest](@ref)"><a href="#CausalityTools.LocalPermutationTest"><code>LocalPermutationTest</code></a></a><a id="[LocalPermutationTest](@ref)-1"></a><a class="docs-heading-anchor-permalink" href="#[LocalPermutationTest](@ref)" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="CausalityTools.LocalPermutationTest" href="#CausalityTools.LocalPermutationTest"><code>CausalityTools.LocalPermutationTest</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">LocalPermutationTest &lt;: IndependenceTest
LocalPermutationTest(measure, [est];
    kperm::Int = 5,
    nshuffles::Int = 100,
    rng = Random.default_rng())</code></pre><p><code>LocalPermutationTest</code> is a generic conditional independence test (Runge, 2018)<sup class="footnote-reference"><a id="citeref-Runge2018" href="#footnote-Runge2018">[Runge2018]</a></sup> for assessing whether two variables <code>X</code> and <code>Y</code> are conditionally independendent given a third variable <code>Z</code> (all of which may be multivariate).</p><p>Any association <code>measure</code> (with a compatible estimator <code>est</code>, if relevant) with ordering <span>$\hat{M}(X; Y | Z)$</span> (conditional variable is the third) can be used. To obtain the nearest-neighbor approach in Runge, 2018, use the <a href="../measures/#CausalityTools.CMIShannon"><code>CMIShannon</code></a> measure with the <a href="../api/api_condmutualinfo/#CausalityTools.FPVP"><code>FPVP</code></a> estimator.</p><p><strong>Description</strong></p><p>This is a generic one-sided hypothesis test that checks whether <code>x</code> and <code>y</code> are independent (given <code>z</code>, if provided) based on resampling from a null distribution assumed to represent independence between the variables. The null distribution is generated by repeatedly shuffling the input data in some way that is intended to break any dependence between the input variables.</p><p>For each shuffle, the provided <code>measure</code> is computed (using <code>est</code>, if relevant) while keeping <code>Y</code> and <code>Z</code> fixed, but permuting <code>X</code>, i.e. <span>$\hat{M}(\hat{X}; Y | Z)$</span>. Each shuffle of <code>X</code> is done conditional on <code>Z</code>, such that <code>xᵢ</code> is replaced with <code>xⱼ</code> only if <code>zᵢ ≈ zⱼ</code>, i.e. <code>zᵢ</code> and <code>zⱼ</code> are close. Closeness is determined by a <code>kperm</code>-th nearest neighbor search among the points in <code>Z</code>, and permuted points are constructed as <span>$(x_i^*, y_i, z_i)_{i=1}^N$</span>, where the goal is that <span>$x_i^*$</span> are drawn without replacement, and <span>$x_i$</span> is replaced by <span>$x_j$</span> only if <span>$z_i \approx z_j$</span>. This procedure is repeated <code>nshuffles</code> times, and a test summary is returned.</p><p><strong>Examples</strong></p><p>See <a href="@ref quickstart_localpermutationtest">quickstart examples</a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/CausalityTools.jl/blob/3ee72504059458ef2c630f102bcd936fd022f804/src/independence_tests/local_permutation/LocalPermutationTest.jl#L30-L72">source</a></section></article><h2 id="[JointDistanceDistributionTest](@ref)"><a class="docs-heading-anchor" href="#[JointDistanceDistributionTest](@ref)"><a href="#CausalityTools.JointDistanceDistributionTest"><code>JointDistanceDistributionTest</code></a></a><a id="[JointDistanceDistributionTest](@ref)-1"></a><a class="docs-heading-anchor-permalink" href="#[JointDistanceDistributionTest](@ref)" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="CausalityTools.JointDistanceDistributionTest" href="#CausalityTools.JointDistanceDistributionTest"><code>CausalityTools.JointDistanceDistributionTest</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">JointDistanceDistributionTest &lt;: IndependenceTest
JointDistanceDistributionTest(measure::JointDistanceDistribution; rng = Random.default_rng())</code></pre><p>An independence test for two variables based on the <a href="../measures/#CausalityTools.JointDistanceDistribution"><code>JointDistanceDistribution</code></a> (Amigó &amp; Hirata, 2018)<sup class="footnote-reference"><a id="citeref-Amigo2018" href="#footnote-Amigo2018">[Amigo2018]</a></sup>.</p><p><strong>Description</strong></p><p>The joint distance distribution (labelled <code>Δ</code> in their paper) is used by Amigó &amp; Hirata (2018) to detect directional couplings of the form <span>$X \to Y$</span> or <span>$Y \to X$</span>. <code>JointDistanceDistributionTest</code> formulates their method as an independence test.</p><p>Formally, we test the hypothesis <span>$H_0$</span> (the variables are independent) against <span>$H_1$</span> (there is directional coupling between the variables). To do so, we use a right-sided/upper-tailed t-test to check mean of <code>Δ</code> is skewed towards positive value, i.e.</p><ul><li><span>$H_0 := \mu(\Delta) = 0$</span></li><li><span>$H_1 := \mu(\Delta) &gt; 0$</span>.</li></ul><p>When used with <a href="#CausalityTools.independence"><code>independence</code></a>, a <code>JDDTestResult</code> is returned, which contains the joint distance distribution and a p-value. If you only need <code>Δ</code>, use <a href="../measures/#CausalityTools.jdd"><code>jdd</code></a> directly.</p><p><strong>Examples</strong></p><p><a href="../examples/examples_independence/#quickstart_jddtest">This example</a> shows how the <code>JointDistanceDistributionTest</code> can be used in practice.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/CausalityTools.jl/blob/3ee72504059458ef2c630f102bcd936fd022f804/src/independence_tests/parametric/JointDistanceDistributionTest.jl#L6-L38">source</a></section></article><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-Runge2018"><a class="tag is-link" href="#citeref-Runge2018">Runge2018</a>Runge, J. (2018, March). Conditional independence testing based on a nearest-neighbor estimator of conditional mutual information. In International Conference on Artificial Intelligence and Statistics (pp. 938-947). PMLR.</li><li class="footnote" id="footnote-Amigo2018"><a class="tag is-link" href="#citeref-Amigo2018">Amigo2018</a>Amigó, José M., and Yoshito Hirata. &quot;Detecting directional couplings from multivariate flows by the joint distance distribution.&quot; Chaos: An Interdisciplinary Journal of Nonlinear Science 28.7 (2018): 075302.</li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../measures/">« Association measures</a><a class="docs-footer-nextpage" href="../api/">APIs and estimators »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Friday 10 February 2023 15:52">Friday 10 February 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
