<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Independence testing · CausalityTools.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="https://fonts.googleapis.com/css?family=Montserrat|Source+Code+Pro&amp;display=swap" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img class="docs-light-only" src="../assets/logo.png" alt="CausalityTools.jl logo"/><img class="docs-dark-only" src="../assets/logo-dark.png" alt="CausalityTools.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">CausalityTools.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Overview</a></li><li><a class="tocitem" href="../measures/">Association measures</a></li><li class="is-active"><a class="tocitem" href>Independence testing</a><ul class="internal"><li><a class="tocitem" href="#Independence-testing-API"><span>Independence testing API</span></a></li><li><a class="tocitem" href="#[SurrogateTest](@ref)"><span><code>SurrogateTest</code></span></a></li><li><a class="tocitem" href="#[LocalPermutationTest](@ref)"><span><code>LocalPermutationTest</code></span></a></li><li><a class="tocitem" href="#[JointDistanceDistributionTest](@ref)"><span><code>JointDistanceDistributionTest</code></span></a></li><li><a class="tocitem" href="#[CorrTest](@ref)"><span><code>CorrTest</code></span></a></li></ul></li><li><a class="tocitem" href="../causal_graphs/">Causal graphs</a></li><li><a class="tocitem" href="../api/">APIs and estimators</a></li><li><a class="tocitem" href="../examples/">Examples</a></li><li><a class="tocitem" href="../coupled_systems/">Predefined systems</a></li><li><a class="tocitem" href="../experimental/">Experimental</a></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Independence testing</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Independence testing</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaDynamics/CausalityTools.jl/blob/master/docs/src/independence.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="independence_testing"><a class="docs-heading-anchor" href="#independence_testing">Independence testing</a><a id="independence_testing-1"></a><a class="docs-heading-anchor-permalink" href="#independence_testing" title="Permalink"></a></h1><h2 id="Independence-testing-API"><a class="docs-heading-anchor" href="#Independence-testing-API">Independence testing API</a><a id="Independence-testing-API-1"></a><a class="docs-heading-anchor-permalink" href="#Independence-testing-API" title="Permalink"></a></h2><p>The independence test API is defined by</p><ul><li><a href="#CausalityTools.independence"><code>independence</code></a></li><li><a href="#CausalityTools.IndependenceTest"><code>IndependenceTest</code></a></li></ul><article class="docstring"><header><a class="docstring-binding" id="CausalityTools.independence" href="#CausalityTools.independence"><code>CausalityTools.independence</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">independence(test::IndependenceTest, x, y, [z]) → summary</code></pre><p>Perform the given <a href="#CausalityTools.IndependenceTest"><code>IndependenceTest</code></a> <code>test</code> on data <code>x</code>, <code>y</code> and <code>z</code>. If only <code>x</code> and <code>y</code> are given, <code>test</code> must provide a bivariate association measure. If <code>z</code> is given too, then <code>test</code> must provide a conditional association measure.</p><p>Returns a test <code>summary</code>, whose type depends on <code>test</code>.</p><p><strong>Compatible independence tests</strong></p><ul><li><a href="#CausalityTools.SurrogateTest"><code>SurrogateTest</code></a>.</li><li><a href="#CausalityTools.LocalPermutationTest"><code>LocalPermutationTest</code></a>.</li><li><a href="#CausalityTools.JointDistanceDistributionTest"><code>JointDistanceDistributionTest</code></a>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/CausalityTools.jl/blob/74bb6f866750ac39983ff37fc680090512f1dc6d/src/independence_tests/independence.jl#L15-L29">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CausalityTools.IndependenceTest" href="#CausalityTools.IndependenceTest"><code>CausalityTools.IndependenceTest</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">IndependenceTest &lt;: IndependenceTest</code></pre><p>The supertype for all independence tests.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/CausalityTools.jl/blob/74bb6f866750ac39983ff37fc680090512f1dc6d/src/independence_tests/independence.jl#L5-L9">source</a></section></article><h2 id="[SurrogateTest](@ref)"><a class="docs-heading-anchor" href="#[SurrogateTest](@ref)"><a href="#CausalityTools.SurrogateTest"><code>SurrogateTest</code></a></a><a id="[SurrogateTest](@ref)-1"></a><a class="docs-heading-anchor-permalink" href="#[SurrogateTest](@ref)" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="CausalityTools.SurrogateTest" href="#CausalityTools.SurrogateTest"><code>CausalityTools.SurrogateTest</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">SurrogateTest &lt;: IndependenceTest
SurrogateTest(measure, [est];
    nshuffles::Int = 100,
    surrogate = RandomShuffle(),
    rng = Random.default_rng(),
)</code></pre><p>A generic (conditional) independence test for assessing whether two variables <code>X</code> and <code>Y</code> are independendent, potentially conditioned on a third variable <code>Z</code>, based on surrogate data.</p><p>When used with <a href="#CausalityTools.independence"><code>independence</code></a>, a <a href="#CausalityTools.SurrogateTestResult"><code>SurrogateTestResult</code></a> is returned.</p><p><strong>Description</strong></p><p>This is a generic one-sided hypothesis test that checks whether <code>x</code> and <code>y</code> are independent (given <code>z</code>, if provided) based on resampling from a null distribution assumed to represent independence between the variables. The null distribution is generated by repeatedly shuffling the input data in some way that is intended to break any dependence between the input variables.</p><p>There are different ways of shuffling, dictated by <code>surrogate</code>, each representing a distinct null hypothesis. For each shuffle, the provided <code>measure</code> is computed (using <code>est</code>, if relevant). This procedure is repeated <code>nshuffles</code> times, and a test summary is returned. The shuffled variable is always the first variable (<code>X</code>). Exceptions are:</p><ul><li>If <a href="../api/api_transferentropy/#CausalityTools.TransferEntropy"><code>TransferEntropy</code></a> measure such as <a href="../measures/#CausalityTools.TEShannon"><code>TEShannon</code></a>,   then the source variable is always shuffled, and the target and conditional   variable are left unshuffled.</li></ul><p><strong>Compatible measures</strong></p><table><tr><th style="text-align: right">Measure</th><th style="text-align: center">Pairwise</th><th style="text-align: center">Conditional</th><th style="text-align: center">Requires <code>est</code></th></tr><tr><td style="text-align: right"><a href="../measures/#CausalityTools.PearsonCorrelation"><code>PearsonCorrelation</code></a></td><td style="text-align: center">✓</td><td style="text-align: center">✖</td><td style="text-align: center">No</td></tr><tr><td style="text-align: right"><a href="../measures/#CausalityTools.DistanceCorrelation"><code>DistanceCorrelation</code></a></td><td style="text-align: center">✓</td><td style="text-align: center">✓</td><td style="text-align: center">No</td></tr><tr><td style="text-align: right"><a href="../measures/#CausalityTools.SMeasure"><code>SMeasure</code></a></td><td style="text-align: center">✓</td><td style="text-align: center">✖</td><td style="text-align: center">No</td></tr><tr><td style="text-align: right"><a href="../measures/#CausalityTools.HMeasure"><code>HMeasure</code></a></td><td style="text-align: center">✓</td><td style="text-align: center">✖</td><td style="text-align: center">No</td></tr><tr><td style="text-align: right"><a href="../measures/#CausalityTools.MMeasure"><code>MMeasure</code></a></td><td style="text-align: center">✓</td><td style="text-align: center">✖</td><td style="text-align: center">No</td></tr><tr><td style="text-align: right"><a href="../measures/#CausalityTools.LMeasure"><code>LMeasure</code></a></td><td style="text-align: center">✓</td><td style="text-align: center">✖</td><td style="text-align: center">No</td></tr><tr><td style="text-align: right"><a href="../measures/#CausalityTools.PairwiseAsymmetricInference"><code>PairwiseAsymmetricInference</code></a></td><td style="text-align: center">✓</td><td style="text-align: center">✖</td><td style="text-align: center">Yes</td></tr><tr><td style="text-align: right"><a href="../measures/#CausalityTools.ConvergentCrossMapping"><code>ConvergentCrossMapping</code></a></td><td style="text-align: center">✓</td><td style="text-align: center">✖</td><td style="text-align: center">Yes</td></tr><tr><td style="text-align: right"><a href="../measures/#CausalityTools.MIShannon"><code>MIShannon</code></a></td><td style="text-align: center">✓</td><td style="text-align: center">✖</td><td style="text-align: center">Yes</td></tr><tr><td style="text-align: right"><a href="../measures/#CausalityTools.MIRenyiJizba"><code>MIRenyiJizba</code></a></td><td style="text-align: center">✓</td><td style="text-align: center">✖</td><td style="text-align: center">Yes</td></tr><tr><td style="text-align: right"><a href="../measures/#CausalityTools.MIRenyiSarbu"><code>MIRenyiSarbu</code></a></td><td style="text-align: center">✓</td><td style="text-align: center">✖</td><td style="text-align: center">Yes</td></tr><tr><td style="text-align: right"><a href="../measures/#CausalityTools.MITsallisMartin"><code>MITsallisMartin</code></a></td><td style="text-align: center">✓</td><td style="text-align: center">✖</td><td style="text-align: center">Yes</td></tr><tr><td style="text-align: right"><a href="../measures/#CausalityTools.MITsallisFuruichi"><code>MITsallisFuruichi</code></a></td><td style="text-align: center">✓</td><td style="text-align: center">✖</td><td style="text-align: center">Yes</td></tr><tr><td style="text-align: right"><a href="../measures/#CausalityTools.PartialCorrelation"><code>PartialCorrelation</code></a></td><td style="text-align: center">✖</td><td style="text-align: center">✓</td><td style="text-align: center">Yes</td></tr><tr><td style="text-align: right"><a href="../measures/#CausalityTools.CMIShannon"><code>CMIShannon</code></a></td><td style="text-align: center">✖</td><td style="text-align: center">✓</td><td style="text-align: center">Yes</td></tr><tr><td style="text-align: right"><a href="../measures/#CausalityTools.CMIRenyiJizba"><code>CMIRenyiJizba</code></a></td><td style="text-align: center">✖</td><td style="text-align: center">✓</td><td style="text-align: center">Yes</td></tr><tr><td style="text-align: right"><a href="../measures/#CausalityTools.TEShannon"><code>TEShannon</code></a></td><td style="text-align: center">✓</td><td style="text-align: center">✓</td><td style="text-align: center">Yes</td></tr><tr><td style="text-align: right"><a href="../measures/#CausalityTools.TERenyiJizba"><code>TERenyiJizba</code></a></td><td style="text-align: center">✓</td><td style="text-align: center">✓</td><td style="text-align: center">Yes</td></tr><tr><td style="text-align: right"><a href="../measures/#CausalityTools.PMI"><code>PMI</code></a></td><td style="text-align: center">✖</td><td style="text-align: center">✓</td><td style="text-align: center">Yes</td></tr></table><p><strong>Examples</strong></p><ul><li><a href="../examples/examples_independence/#examples_surrogatetest_distancecorrelation">Pairwise test, <code>DistanceCorrelation</code></a>.</li><li><a href="../examples/examples_independence/#examples_surrogatetest_teshannon">Pairwise test, <code>TEShannon</code></a>.</li><li><a href="../examples/examples_independence/#examples_surrogatetest_partialcorrelation">Conditional test, <code>PartialCorrelation</code></a>.</li><li><a href="../examples/examples_independence/#examples_surrogatetest_mishannon_categorical">Pairwise test, <code>MIShannon</code>, categorical</a>.</li><li><a href="../examples/examples_independence/#examples_surrogatetest_cmishannon_categorical">Conditional test, <code>CMIShannon</code>, categorical</a>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/CausalityTools.jl/blob/74bb6f866750ac39983ff37fc680090512f1dc6d/src/independence_tests/surrogate/SurrogateTest.jl#L6-L68">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CausalityTools.SurrogateTestResult" href="#CausalityTools.SurrogateTestResult"><code>CausalityTools.SurrogateTestResult</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">SurrogateTestResult(m, m_surr, pvalue)</code></pre><p>Holds the result of a <a href="#CausalityTools.SurrogateTest"><code>SurrogateTest</code></a>. <code>m</code> is the measure computed on the original data. <code>m_surr</code> is a vector of the measure computed on permuted data, where <code>m_surr[i]</code> is the measure compute on the <code>i</code>-th permutation. <code>pvalue</code> is the one-sided <code>p</code>-value for the test.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/CausalityTools.jl/blob/74bb6f866750ac39983ff37fc680090512f1dc6d/src/independence_tests/surrogate/SurrogateTest.jl#L98-L105">source</a></section></article><h2 id="[LocalPermutationTest](@ref)"><a class="docs-heading-anchor" href="#[LocalPermutationTest](@ref)"><a href="#CausalityTools.LocalPermutationTest"><code>LocalPermutationTest</code></a></a><a id="[LocalPermutationTest](@ref)-1"></a><a class="docs-heading-anchor-permalink" href="#[LocalPermutationTest](@ref)" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="CausalityTools.LocalPermutationTest" href="#CausalityTools.LocalPermutationTest"><code>CausalityTools.LocalPermutationTest</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">LocalPermutationTest &lt;: IndependenceTest
LocalPermutationTest(measure, [est];
    kperm::Int = 5,
    nshuffles::Int = 100,
    rng = Random.default_rng(),
    replace = true,
    w::Int = 0)</code></pre><p><code>LocalPermutationTest</code> is a generic conditional independence test <a href="../references/#Runge2018LocalPerm">(Runge, 2018)</a> for assessing whether two variables <code>X</code> and <code>Y</code> are conditionally independendent given a third variable <code>Z</code> (all of which may be multivariate).</p><p>When used with <a href="#CausalityTools.independence"><code>independence</code></a>, a <a href="#CausalityTools.LocalPermutationTestResult"><code>LocalPermutationTestResult</code></a> is returned.</p><p><strong>Description</strong></p><p>This is a generic one-sided hypothesis test that checks whether <code>X</code> and <code>Y</code> are independent (given <code>Z</code>, if provided) based on resampling from a null distribution assumed to represent independence between the variables. The null distribution is generated by repeatedly shuffling the input data in some way that is intended to break any dependence between <code>x</code> and <code>y</code>, but preserve dependencies between <code>x</code> and <code>z</code>.</p><p>The algorithm is as follows:</p><ol><li>Compute the original conditional independence statistic <code>I(X; Y | Z)</code>.</li><li>Allocate a scalar valued vector <code>Î</code> with space for <code>nshuffles</code> elements.</li><li>For <code>k ∈ [1, 2, …, nshuffles]</code>, repeat<ul><li>For each <code>zᵢ ∈ Y</code>, let <code>nᵢ</code> be time indices of the <code>kperm</code> nearest neighbors of <code>zᵢ</code>,   excluding the <code>w</code> nearest neighbors of <code>zᵢ</code> from the neighbor query (i.e <code>w</code> is   the Theiler window).</li><li>Let <code>xᵢ⋆ = X[j]</code>, where <code>j</code> is randomly sampled from <code>nᵢ</code> with replacement.   This way, <code>xᵢ</code> is replaced with <code>xⱼ</code> only if <code>zᵢ ≈ zⱼ</code> (<code>zᵢ</code> and <code>zⱼ</code> are close).   Repeat for <code>i = 1, 2, …, n</code> and obtain the shuffled <code>X̂ = [x̂₁, x̂₂, …, x̂ₙ]</code>.</li><li>Compute the conditional independence statistic <code>Iₖ(X̂; Y | Z)</code>.</li><li>Let <code>Î[k] = Iₖ(X̂; Y | Z)</code>.</li></ul></li><li>Compute the p-value as <code>count(Î[k] .&lt;= I) / nshuffles)</code>.</li></ol><p>In additional to the conditional variant from Runge (2018), we also provide a pairwise version, where the shuffling procedure is identical, except neighbors in <code>Y</code> are used instead of <code>Z</code> and we <code>I(X; Y)</code> and <code>Iₖ(X̂; Y)</code> instead of <code>I(X; Y | Z)</code> and <code>Iₖ(X̂; Y | Z)</code>.</p><p><strong>Compatible measures</strong></p><table><tr><th style="text-align: right">Measure</th><th style="text-align: center">Pairwise</th><th style="text-align: center">Conditional</th><th style="text-align: center">Requires <code>est</code></th></tr><tr><td style="text-align: right"><a href="../measures/#CausalityTools.PartialCorrelation"><code>PartialCorrelation</code></a></td><td style="text-align: center">✖</td><td style="text-align: center">✓</td><td style="text-align: center">No</td></tr><tr><td style="text-align: right"><a href="../measures/#CausalityTools.DistanceCorrelation"><code>DistanceCorrelation</code></a></td><td style="text-align: center">✖</td><td style="text-align: center">✓</td><td style="text-align: center">No</td></tr><tr><td style="text-align: right"><a href="../measures/#CausalityTools.CMIShannon"><code>CMIShannon</code></a></td><td style="text-align: center">✖</td><td style="text-align: center">✓</td><td style="text-align: center">Yes</td></tr><tr><td style="text-align: right"><a href="../measures/#CausalityTools.TEShannon"><code>TEShannon</code></a></td><td style="text-align: center">✓</td><td style="text-align: center">✓</td><td style="text-align: center">Yes</td></tr><tr><td style="text-align: right"><a href="../measures/#CausalityTools.PMI"><code>PMI</code></a></td><td style="text-align: center">✖</td><td style="text-align: center">✓</td><td style="text-align: center">Yes</td></tr></table><p>The <code>LocalPermutationTest</code> is only defined for conditional independence testing. Exceptions are for measures like <a href="../measures/#CausalityTools.TEShannon"><code>TEShannon</code></a>, which use conditional measures under the hood even for their pairwise variants, and are therefore compatible with <code>LocalPermutationTest</code>.</p><p>The nearest-neighbor approach in Runge (2018) can be reproduced by using the <a href="../measures/#CausalityTools.CMIShannon"><code>CMIShannon</code></a> measure with the <a href="../api/api_condmutualinfo/#CausalityTools.FPVP"><code>FPVP</code></a> estimator.</p><p><strong>Examples</strong></p><ul><li><a href="../examples/examples_independence/#example_localpermtest_cmishannon">Example using <code>CMIShannon</code></a>.</li><li><a href="../examples/examples_independence/#example_localpermtest_teshannon">Example using <code>TEShannon</code></a>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/CausalityTools.jl/blob/74bb6f866750ac39983ff37fc680090512f1dc6d/src/independence_tests/local_permutation/LocalPermutationTest.jl#L30-L95">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CausalityTools.LocalPermutationTestResult" href="#CausalityTools.LocalPermutationTestResult"><code>CausalityTools.LocalPermutationTestResult</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">LocalPermutationTestResult(m, m_surr, pvalue)</code></pre><p>Holds the result of a <a href="#CausalityTools.LocalPermutationTest"><code>LocalPermutationTest</code></a>. <code>m</code> is the measure computed on the original data. <code>m_surr</code> is a vector of the measure computed on permuted data, where <code>m_surr[i]</code> is the measure compute on the <code>i</code>-th permutation. <code>pvalue</code> is the one-sided <code>p</code>-value for the test.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/CausalityTools.jl/blob/74bb6f866750ac39983ff37fc680090512f1dc6d/src/independence_tests/local_permutation/LocalPermutationTest.jl#L128-L135">source</a></section></article><h2 id="[JointDistanceDistributionTest](@ref)"><a class="docs-heading-anchor" href="#[JointDistanceDistributionTest](@ref)"><a href="#CausalityTools.JointDistanceDistributionTest"><code>JointDistanceDistributionTest</code></a></a><a id="[JointDistanceDistributionTest](@ref)-1"></a><a class="docs-heading-anchor-permalink" href="#[JointDistanceDistributionTest](@ref)" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="CausalityTools.JointDistanceDistributionTest" href="#CausalityTools.JointDistanceDistributionTest"><code>CausalityTools.JointDistanceDistributionTest</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">JointDistanceDistributionTest &lt;: IndependenceTest
JointDistanceDistributionTest(measure::JointDistanceDistribution; rng = Random.default_rng())</code></pre><p>An independence test for two variables based on the <a href="../measures/#CausalityTools.JointDistanceDistribution"><code>JointDistanceDistribution</code></a> <a href="../references/#Amigo2018">(Amigó and Hirata, 2018)</a>.</p><p>When used with <a href="#CausalityTools.independence"><code>independence</code></a>, a <a href="#CausalityTools.JDDTestResult"><code>JDDTestResult</code></a> is returned.</p><p><strong>Description</strong></p><p>The joint distance distribution (labelled <code>Δ</code> in their paper) is used by Amigó &amp; Hirata (2018) to detect directional couplings of the form <span>$X \to Y$</span> or <span>$Y \to X$</span>. <code>JointDistanceDistributionTest</code> formulates their method as an independence test.</p><p>Formally, we test the hypothesis <span>$H_0$</span> (the variables are independent) against <span>$H_1$</span> (there is directional coupling between the variables). To do so, we use a right-sided/upper-tailed t-test to check mean of <code>Δ</code> is skewed towards positive value, i.e.</p><ul><li><span>$H_0 := \mu(\Delta) = 0$</span></li><li><span>$H_1 := \mu(\Delta) &gt; 0$</span>.</li></ul><p>When used with <a href="#CausalityTools.independence"><code>independence</code></a>, a <code>JDDTestResult</code> is returned, which contains the joint distance distribution and a p-value. If you only need <code>Δ</code>, use <a href="../measures/#CausalityTools.jdd"><code>jdd</code></a> directly.</p><p><strong>Examples</strong></p><p><a href="../examples/examples_independence/#quickstart_jddtest">This example</a> shows how the <code>JointDistanceDistributionTest</code> can be used in practice.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/CausalityTools.jl/blob/74bb6f866750ac39983ff37fc680090512f1dc6d/src/independence_tests/parametric/JointDistanceDistributionTest.jl#L8-L37">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CausalityTools.JDDTestResult" href="#CausalityTools.JDDTestResult"><code>CausalityTools.JDDTestResult</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">JDDTestResult(Δjdd, hypothetical_μ, pvalue)</code></pre><p>Holds the results of <a href="#CausalityTools.JointDistanceDistributionTest"><code>JointDistanceDistributionTest</code></a>. <code>Δjdd</code> is the <code>Δ</code>-distribution, <code>hypothetical_μ</code> is the hypothetical mean of the <code>Δ</code>-distribution under the null, and <code>pvalue</code> is the p-value for the one-sided t-test.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/CausalityTools.jl/blob/74bb6f866750ac39983ff37fc680090512f1dc6d/src/independence_tests/parametric/JointDistanceDistributionTest.jl#L52-L58">source</a></section></article><h2 id="[CorrTest](@ref)"><a class="docs-heading-anchor" href="#[CorrTest](@ref)"><a href="#CausalityTools.CorrTest"><code>CorrTest</code></a></a><a id="[CorrTest](@ref)-1"></a><a class="docs-heading-anchor-permalink" href="#[CorrTest](@ref)" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="CausalityTools.CorrTest" href="#CausalityTools.CorrTest"><code>CausalityTools.CorrTest</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">CorrTest &lt;: IndependenceTest
CorrTest()</code></pre><p>An independence test based correlation (for two variables) and partial correlation (for three variables) (<a href="../references/#Levy1978">Levy and Narula (1978)</a>@; as described in <a href="../references/#Schmidt2018">Schmidt <em>et al.</em> (2018)</a>).</p><p>Uses <a href="../measures/#CausalityTools.PearsonCorrelation"><code>PearsonCorrelation</code></a> and <a href="../measures/#CausalityTools.PartialCorrelation"><code>PartialCorrelation</code></a> internally.</p><p>Assumes that the input data are (multivariate) normally distributed. Then <code>ρ(X, Y) = 0</code> implies <code>X ⫫ Y</code> and <code>ρ(X, Y | 𝐙) = 0</code> implies <code>X ⫫ Y | 𝐙</code>.</p><p><strong>Description</strong></p><p>The null hypothesis is <code>H₀ := ρ(X, Y | 𝐙) = 0</code>. We use the approach in Levy &amp; Narula (1978)<a href="../references/#Levy1978">(Levy and Narula, 1978)</a> and compute the Z-transformation of the observed (partial) correlation coefficient <span>$\hat{\rho}_{XY|\bf{Z}}$</span>:</p><p class="math-container">\[Z(\hat{\rho}_{XY|\bf{Z}}) =
\log\dfrac{1 + \hat{\rho}_{XY|\bf{Z}}}{1 - \hat{\rho}_{XY|\bf{Z}}}.\]</p><p>To test the null hypothesis against the alternative hypothesis <code>H₁ := ρ(X, Y | 𝐙) &gt; 0</code>, calculate</p><p class="math-container">\[\hat{Z} = \dfrac{1}{2}\dfrac{Z(\hat{\rho}_{XY|\bf{Z}}) - Z(0)}{\sqrt{1/(n - d - 3)}},\]</p><p>and compute the two-sided p-value (Schmidt et al., 2018)</p><p class="math-container">\[p(X, Y | \bf{Z}) = 2(1 - \phi(\sqrt{n - d - 3}Z(\hat{\rho}_{XY|\bf{Z}}))),\]</p><p>where <span>$d$</span> is the dimension of <span>$\bf{Z}$</span> and <span>$n$</span> is the number of samples. For the pairwise case, the procedure is identical, but set <span>$\bf{Z} = \emptyset$</span>.</p><p><strong>Examples</strong></p><ul><li><a href="../examples/examples_independence/#examples_corrtest"><code>CorrTest</code>for independence between normally distributed data</a>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/CausalityTools.jl/blob/74bb6f866750ac39983ff37fc680090512f1dc6d/src/independence_tests/parametric/CorrTest.jl#L10-L53">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CausalityTools.CorrTestResult" href="#CausalityTools.CorrTestResult"><code>CausalityTools.CorrTestResult</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">CorrTestResult(pvalue, ρ, z)</code></pre><p>A simple struct that holds the results of a <a href="#CausalityTools.CorrTest"><code>CorrTest</code></a> test: the (partial) correlation coefficient <code>ρ</code>, Fisher&#39;s <code>z</code>, and <code>pvalue</code> - the two-sided p-value for the test.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/CausalityTools.jl/blob/74bb6f866750ac39983ff37fc680090512f1dc6d/src/independence_tests/parametric/CorrTest.jl#L58-L64">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../measures/">« Association measures</a><a class="docs-footer-nextpage" href="../causal_graphs/">Causal graphs »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Sunday 3 September 2023 17:59">Sunday 3 September 2023</span>. Using Julia version 1.9.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
